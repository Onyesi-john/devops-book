<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">

<meta http-equiv="X-UA-Compatible" content="IE=edge">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="generator" content="Asciidoctor 2.0.16">

<title>Part 4. How to Version, Build, and Test Your Code</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">

<style>

/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */

/* Uncomment the following line when using as a custom stylesheet */

/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */

html{font-family:sans-serif;-webkit-text-size-adjust:100%}

a{background:none}

a:focus{outline:thin dotted}

a:active,a:hover{outline:0}

h1{font-size:2em;margin:.67em 0}

b,strong{font-weight:bold}

abbr{font-size:.9em}

abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}

dfn{font-style:italic}

hr{height:0}

mark{background:#ff0;color:#000}

code,kbd,pre,samp{font-family:monospace;font-size:1em}

pre{white-space:pre-wrap}

q{quotes:"\201C" "\201D" "\2018" "\2019"}

small{font-size:80%}

sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}

sup{top:-.5em}

sub{bottom:-.25em}

img{border:0}

svg:not(:root){overflow:hidden}

figure{margin:0}

audio,video{display:inline-block}

audio:not([controls]){display:none;height:0}

fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}

legend{border:0;padding:0}

button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}

button,input{line-height:normal}

button,select{text-transform:none}

button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}

button[disabled],html input[disabled]{cursor:default}

input[type=checkbox],input[type=radio]{padding:0}

button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}

textarea{overflow:auto;vertical-align:top}

table{border-collapse:collapse;border-spacing:0}

*,::before,::after{box-sizing:border-box}

html,body{font-size:100%}

body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}

a:hover{cursor:pointer}

img,object,embed{max-width:100%;height:auto}

object,embed{height:100%}

img{-ms-interpolation-mode:bicubic}

.left{float:left!important}

.right{float:right!important}

.text-left{text-align:left!important}

.text-right{text-align:right!important}

.text-center{text-align:center!important}

.text-justify{text-align:justify!important}

.hide{display:none}

img,object,svg{display:inline-block;vertical-align:middle}

textarea{height:auto;min-height:50px}

select{width:100%}

.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}

div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}

a{color:#2156a5;text-decoration:underline;line-height:inherit}

a:hover,a:focus{color:#1d4b8f}

a img{border:0}

p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}

p aside{font-size:.875em;line-height:1.35;font-style:italic}

h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}

h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}

h1{font-size:2.125em}

h2{font-size:1.6875em}

h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}

h4,h5{font-size:1.125em}

h6{font-size:1em}

hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}

em,i{font-style:italic;line-height:inherit}

strong,b{font-weight:bold;line-height:inherit}

small{font-size:60%;line-height:inherit}

code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}

ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}

ul,ol{margin-left:1.5em}

ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}

ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}

ul.square{list-style-type:square}

ul.circle{list-style-type:circle}

ul.disc{list-style-type:disc}

ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}

dl dt{margin-bottom:.3125em;font-weight:bold}

dl dd{margin-bottom:1.25em}

blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}

blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}

@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}

h1{font-size:2.75em}

h2{font-size:2.3125em}

h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}

h4{font-size:1.4375em}}

table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}

table thead,table tfoot{background:#f7f8f7}

table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}

table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}

table tr.even,table tr.alt{background:#f8f8f7}

table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}

h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}

h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}

.center{margin-left:auto;margin-right:auto}

.stretch{width:100%}

.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}

.clearfix::after,.float-group::after{clear:both}

:not(pre).nobreak{word-wrap:normal}

:not(pre).nowrap{white-space:nowrap}

:not(pre).pre-wrap{white-space:pre-wrap}

:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}

pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}

pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}

pre>code{display:block}

pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}

em em{font-style:normal}

strong strong{font-weight:400}

.keyseq{color:rgba(51,51,51,.8)}

kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}

.keyseq kbd:first-child{margin-left:0}

.keyseq kbd:last-child{margin-right:0}

.menuseq,.menuref{color:#000}

.menuseq b:not(.caret),.menuref{font-weight:inherit}

.menuseq{word-spacing:-.02em}

.menuseq b.caret{font-size:1.25em;line-height:.8}

.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}

b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}

b.button::before{content:"[";padding:0 3px 0 2px}

b.button::after{content:"]";padding:0 2px 0 3px}

p a>code:hover{color:rgba(0,0,0,.9)}

#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}

#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}

#header::after,#content::after,#footnotes::after,#footer::after{clear:both}

#content{margin-top:1.25em}

#content::before{content:none}

#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}

#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}

#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}

#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}

#header .details span:first-child{margin-left:-.125em}

#header .details span.email a{color:rgba(0,0,0,.85)}

#header .details br{display:none}

#header .details br+span::before{content:"\00a0\2013\00a0"}

#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}

#header .details br+span#revremark::before{content:"\00a0|\00a0"}

#header #revnumber{text-transform:capitalize}

#header #revnumber::after{content:"\00a0"}

#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}

#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}

#toc>ul{margin-left:.125em}

#toc ul.sectlevel0>li>a{font-style:italic}

#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}

#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}

#toc li{line-height:1.3334;margin-top:.3334em}

#toc a{text-decoration:none}

#toc a:active{text-decoration:underline}

#toctitle{color:#7a2518;font-size:1.2em}

@media screen and (min-width:768px){#toctitle{font-size:1.375em}

body.toc2{padding-left:15em;padding-right:0}

#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}

#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}

#toc.toc2>ul{font-size:.9em;margin-bottom:0}

#toc.toc2 ul ul{margin-left:0;padding-left:1em}

#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}

body.toc2.toc-right{padding-left:0;padding-right:15em}

body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}

@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}

#toc.toc2{width:20em}

#toc.toc2 #toctitle{font-size:1.375em}

#toc.toc2>ul{font-size:.95em}

#toc.toc2 ul ul{padding-left:1.25em}

body.toc2.toc-right{padding-left:0;padding-right:20em}}

#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}

#content #toc>:first-child{margin-top:0}

#content #toc>:last-child{margin-bottom:0}

#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}

#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}

#content{margin-bottom:.625em}

.sect1{padding-bottom:.625em}

@media screen and (min-width:768px){#content{margin-bottom:1.25em}

.sect1{padding-bottom:1.25em}}

.sect1:last-child{padding-bottom:0}

.sect1+.sect1{border-top:1px solid #e7e7e9}

#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}

#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}

#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}

#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}

#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}

details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}

details{margin-left:1.25rem}

details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}

details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}

details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}

details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}

.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}

table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}

.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}

.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}

.admonitionblock>table td.icon{text-align:center;width:80px}

.admonitionblock>table td.icon img{max-width:none}

.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}

.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}

.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}

.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}

.exampleblock>.content>:first-child{margin-top:0}

.exampleblock>.content>:last-child{margin-bottom:0}

.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}

.sidebarblock>:first-child{margin-top:0}

.sidebarblock>:last-child{margin-bottom:0}

.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}

.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}

.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}

@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}

@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}

.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}

.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}

.listingblock>.content{position:relative}

.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}

.listingblock:hover code[data-lang]::before{display:block}

.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}

.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}

.listingblock pre.highlightjs{padding:0}

.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}

.listingblock pre.prettyprint{border-width:0}

.prettyprint{background:#f7f7f8}

pre.prettyprint .linenums{line-height:1.45;margin-left:2em}

pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}

pre.prettyprint li code[data-lang]::before{opacity:1}

pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}

table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}

table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}

table.linenotable td.code{padding-left:.75em}

table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}

pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}

pre.pygments .lineno::before{content:"";margin-right:-.125em}

.quoteblock{margin:0 1em 1.25em 1.5em;display:table}

.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}

.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}

.quoteblock blockquote{margin:0;padding:0;border:0}

.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}

.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}

.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}

.verseblock{margin:0 1em 1.25em}

.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}

.verseblock pre strong{font-weight:400}

.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}

.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}

.quoteblock .attribution br,.verseblock .attribution br{display:none}

.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}

.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}

.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}

.quoteblock.abstract{margin:0 1em 1.25em;display:block}

.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}

.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}

.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}

.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}

.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}

p.tableblock:last-child{margin-bottom:0}

td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}

td.tableblock>.content>:last-child{margin-bottom:-1.25em}

table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}

table.grid-all>*>tr>*{border-width:1px}

table.grid-cols>*>tr>*{border-width:0 1px}

table.grid-rows>*>tr>*{border-width:1px 0}

table.frame-all{border-width:1px}

table.frame-ends{border-width:1px 0}

table.frame-sides{border-width:0 1px}

table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}

table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}

table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}

table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}

table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}

th.halign-left,td.halign-left{text-align:left}

th.halign-right,td.halign-right{text-align:right}

th.halign-center,td.halign-center{text-align:center}

th.valign-top,td.valign-top{vertical-align:top}

th.valign-bottom,td.valign-bottom{vertical-align:bottom}

th.valign-middle,td.valign-middle{vertical-align:middle}

table thead th,table tfoot th{font-weight:bold}

tbody tr th{background:#f7f8f7}

tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}

p.tableblock>code:only-child{background:none;padding:0}

p.tableblock{font-size:1em}

ol{margin-left:1.75em}

ul li ol{margin-left:1.5em}

dl dd{margin-left:1.125em}

dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}

ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}

ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}

ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}

ul.unstyled,ol.unstyled{margin-left:0}

ul.checklist>li>p:first-child{margin-left:-1em}

ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}

ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}

ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}

ul.inline>li{margin-left:1.25em}

.unstyled dl dt{font-weight:400;font-style:normal}

ol.arabic{list-style-type:decimal}

ol.decimal{list-style-type:decimal-leading-zero}

ol.loweralpha{list-style-type:lower-alpha}

ol.upperalpha{list-style-type:upper-alpha}

ol.lowerroman{list-style-type:lower-roman}

ol.upperroman{list-style-type:upper-roman}

ol.lowergreek{list-style-type:lower-greek}

.hdlist>table,.colist>table{border:0;background:none}

.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}

td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}

td.hdlist1{font-weight:bold;padding-bottom:1.25em}

td.hdlist2{word-wrap:anywhere}

.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}

.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}

.colist td:not([class]):first-child img{max-width:none}

.colist td:not([class]):last-child{padding:.25em 0}

.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}

.imageblock.left{margin:.25em .625em 1.25em 0}

.imageblock.right{margin:.25em 0 1.25em .625em}

.imageblock>.title{margin-bottom:0}

.imageblock.thumb,.imageblock.th{border-width:6px}

.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}

.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}

.image.left{margin-right:.625em}

.image.right{margin-left:.625em}

a.image{text-decoration:none;display:inline-block}

a.image object{pointer-events:none}

sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}

sup.footnote a,sup.footnoteref a{text-decoration:none}

sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}

#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}

#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}

#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}

#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}

#footnotes .footnote:last-of-type{margin-bottom:0}

#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}

.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}

.gist .file-data>table td.line-data{width:99%}

div.unbreakable{page-break-inside:avoid}

.big{font-size:larger}

.small{font-size:smaller}

.underline{text-decoration:underline}

.overline{text-decoration:overline}

.line-through{text-decoration:line-through}

.aqua{color:#00bfbf}

.aqua-background{background:#00fafa}

.black{color:#000}

.black-background{background:#000}

.blue{color:#0000bf}

.blue-background{background:#0000fa}

.fuchsia{color:#bf00bf}

.fuchsia-background{background:#fa00fa}

.gray{color:#606060}

.gray-background{background:#7d7d7d}

.green{color:#006000}

.green-background{background:#007d00}

.lime{color:#00bf00}

.lime-background{background:#00fa00}

.maroon{color:#600000}

.maroon-background{background:#7d0000}

.navy{color:#000060}

.navy-background{background:#00007d}

.olive{color:#606000}

.olive-background{background:#7d7d00}

.purple{color:#600060}

.purple-background{background:#7d007d}

.red{color:#bf0000}

.red-background{background:#fa0000}

.silver{color:#909090}

.silver-background{background:#bcbcbc}

.teal{color:#006060}

.teal-background{background:#007d7d}

.white{color:#bfbfbf}

.white-background{background:#fafafa}

.yellow{color:#bfbf00}

.yellow-background{background:#fafa00}

span.icon>.fa{cursor:default}

a span.icon>.fa{cursor:inherit}

.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}

.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}

.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}

.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}

.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}

.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}

.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}

.conum[data-value] *{color:#fff!important}

.conum[data-value]+b{display:none}

.conum[data-value]::after{content:attr(data-value)}

pre .conum[data-value]{position:relative;top:-.125em}

b.conum *{color:inherit!important}

.conum:not([data-value]):empty{display:none}

dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}

h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}

p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}

p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}

p{margin-bottom:1.25rem}

.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}

.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}

.print-only{display:none!important}

@page{margin:1.25cm .75cm}

@media print{*{box-shadow:none!important;text-shadow:none!important}

html{font-size:80%}

a{color:inherit!important;text-decoration:underline!important}

a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}

a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}

abbr[title]{border-bottom:1px dotted}

abbr[title]::after{content:" (" attr(title) ")"}

pre,blockquote,tr,img,object,svg{page-break-inside:avoid}

thead{display:table-header-group}

svg{max-width:100%}

p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}

h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}

#header,#content,#footnotes,#footer{max-width:none}

#toc,.sidebarblock,.exampleblock>.content{background:none!important}

#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}

body.book #header{text-align:center}

body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}

body.book #header .details{border:0!important;display:block;padding:0!important}

body.book #header .details span:first-child{margin-left:0!important}

body.book #header .details br{display:block}

body.book #header .details br+span::before{content:none!important}

body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}

body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}

.listingblock code[data-lang]::before{display:block}

#footer{padding:0 .9375em}

.hide-on-print{display:none!important}

.print-only{display:block!important}

.hide-for-print{display:none!important}

.show-for-print{display:inherit!important}}

@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}

.sect1{padding:0!important}

.sect1+.sect1{border:0}

#footer{background:none}

#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}

@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}

</style>


<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

<style>
h1 {
    margin-bottom: 50px;
}
h2 {
    margin-top: 50px;
    margin-bottom: 10px;
}
h3 {
    margin-top: 30px;
    margin-bottom: 10px;
}
h4 {
    margin-top: 20px;
    margin-bottom: 10px;
}

pre {
    line-height: 12px !important;
    font-size: 14px !important;
    margin-bottom: 0 !important;
}

#toc-dynamic>ul {
    margin: 0;
}

table ul {
    margin-left: 0;
    padding-left: 15px;
}
</style>

</head>

<body class="book" data-bs-spy="scroll" data-bs-target="#toc-dynamic" data-bs-smooth-scroll="true" tabindex="0">

<div class="container">
  <div class="row">
    <div class="col-sm-4">
      <nav id="toc-dynamic" class="sticky-top vh-100" style="overflow: scroll; padding-top: 25px; padding-bottom: 25px;">
          <a href="index.html" class="h6 text-decoration-none">Fundamentals of DevOps and Software Delivery</a>
          <ul class="nav nav-pills flex-column"><li class="nav-item"><a href="#how_to_version_build_test" class="nav-link">4. How to Version, Build, and Test Your Code</a>
</li>

<li class="nav-item"><a href="#_version_control" class="nav-link">4.1. Version control</a>

<ul class="nav nav-pills flex-column">

<li class="nav-item"><a href="#_version_control_primer" class="nav-link">4.1.1. Version control primer</a></li>

<li class="nav-item"><a href="#_example_a_crash_course_on_git" class="nav-link">4.1.2. Example: a crash course on Git</a>

<ul class="nav nav-pills flex-column">

<li class="nav-item"><a href="#_example_git_basics" class="nav-link">Example: Git basics</a></li>

<li class="nav-item"><a href="#_example_git_branching_and_merging" class="nav-link">Example: Git branching and merging</a></li>

</ul>

</li>

<li class="nav-item"><a href="#example_store_code_github" class="nav-link">4.1.3. Example: store your code in GitHub</a></li>

<li class="nav-item"><a href="#_example_open_a_pull_request_in_github" class="nav-link">4.1.4. Example: open a pull request in GitHub</a></li>

<li class="nav-item"><a href="#_version_control_best_practices" class="nav-link">4.1.5. Version control best practices</a>

<ul class="nav nav-pills flex-column">

<li class="nav-item"><a href="#_always_use_version_control" class="nav-link">Always use version control</a></li>

<li class="nav-item"><a href="#_write_good_commit_messages" class="nav-link">Write good commit messages</a></li>

<li class="nav-item"><a href="#_commit_early_and_often" class="nav-link">Commit early and often</a></li>

<li class="nav-item"><a href="#_use_a_code_review_process" class="nav-link">Use a code review process</a></li>

<li class="nav-item"><a href="#protect_your_code" class="nav-link">Protect your code</a></li>

</ul>

</li>

</ul>

</li>

<li class="nav-item"><a href="#_build_system" class="nav-link">4.2. Build system</a>

<ul class="nav nav-pills flex-column">

<li class="nav-item"><a href="#_example_configure_your_build_using_npm" class="nav-link">4.2.1. Example: configure your build using NPM</a></li>

<li class="nav-item"><a href="#_dependency_management" class="nav-link">4.2.2. Dependency management</a></li>

<li class="nav-item"><a href="#_example_add_dependencies_in_npm" class="nav-link">4.2.3. Example: add dependencies in NPM</a></li>

</ul>

</li>

<li class="nav-item"><a href="#automated_testing" class="nav-link">4.3. Automated testing</a>

<ul class="nav nav-pills flex-column">

<li class="nav-item"><a href="#_example_add_automated_tests_for_the_node_js_app" class="nav-link">4.3.1. Example: add automated tests for the Node.js app</a></li>

<li class="nav-item"><a href="#example_automated_tests_tofu" class="nav-link">4.3.2. Example: add automated tests for your OpenTofu code</a>

<ul class="nav nav-pills flex-column">

<li class="nav-item"><a href="#_example_add_static_analysis_for_your_opentofu_code_using_terrascan" class="nav-link">Example: add static analysis for your OpenTofu code using Terrascan</a></li>

<li class="nav-item"><a href="#_example_add_unit_tests_for_your_opentofu_code_using_the_test_command" class="nav-link">Example: add unit tests for your OpenTofu code using the test command</a></li>

</ul>

</li>

<li class="nav-item"><a href="#_testing_best_practices" class="nav-link">4.3.3. Testing best practices</a>

<ul class="nav nav-pills flex-column">

<li class="nav-item"><a href="#_the_test_pyramid" class="nav-link">The test pyramid</a></li>

<li class="nav-item"><a href="#_what_to_test" class="nav-link">What to test</a></li>

<li class="nav-item"><a href="#_test_driven_development_tdd" class="nav-link">Test-Driven Development (TDD)</a></li>

</ul>

</li>

</ul>

</li>

<li class="nav-item"><a href="#_conclusion_4" class="nav-link">4.4. Conclusion</a></li>

</ul>

      </nav>
    </div>
    <div class="col-sm-8">

<div id="content">
<div class="sect1">

<h1 id="how_to_version_build_test">Part 4. How to Version, Build, and Test Your Code</h1>

<div class="sectionbody">

<div class="paragraph">

<p>In <a href="03.html#how_to_manage_your_infra_as_code">Part 2</a> and <a href="04.html#how_to_deploy_many_apps">Part 3</a>, you wrote code using a variety of languages

and tools, including JavaScript (Node.js), Bash, YAML (Ansible), HCL (OpenTofu, Packer), and so on. What did you do

with all of that code? Is it just sitting on your computer? If so, that&#8217;s fine for learning and experimenting, where

you&#8217;re the only one touching that code, but with most real-world code, software development is a team sport, and not

a solo effort. And that means, you need to figure out how to support many developers collaborating safely and

efficiently on the same codebase.</p>

</div>

<div class="paragraph">

<p>In particular, you need to figure out how to solve the following problems:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Code access</dt>

<dd>

<p>All the developers on your team need a way to access the same code so they can all collaborate on it.</p>

</dd>

<dt class="hdlist1">Integration</dt>

<dd>

<p>As multiple developers make changes to the same code base, you need some way to <em>integrate</em> their

changes, handling any conflicts that arise, and ensuring that no one&#8217;s work is accidentally lost or overwritten.</p>

</dd>

<dt class="hdlist1">Correctness</dt>

<dd>

<p>It&#8217;s hard enough to make your own code work, but when multiple people are modifying that code at

the same time, you need to find a way to prevent constant bugs and breakages from slipping in.</p>

</dd>

<dt class="hdlist1">Release</dt>

<dd>

<p>Getting a codebase working is great, but as you may remember from the <a href="index.html#preface">Introduction</a>, code isn&#8217;t done until

it&#8217;s generating value for your users and your company, which means you need a way to <em>release</em> the changes in your

codebase to production on a regular basis.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>These problems are all key parts of your <em>software development life cycle (SDLC)</em>. In the past, many companies would

come up with their own ad-hoc, manual SDLC processes: I&#8217;ve seen places where the developers would email code changes

back and forth, spend weeks integrating changes together manually, test everything manually (if they did any testing at

all), and release everything manually (e.g., by using FTP to upload code to a server). But just because you can do

something doesn&#8217;t mean you should.</p>

</div>

<div class="paragraph">

<p>These days, we have far better tools and techniques for solving these problems. In this post,

you&#8217;ll learn a few of these tools and techniques; in the next post, you&#8217;ll learn how to

put these tools and techniques together into an effective SDLC—the kind of SDLC that makes it possible to achieve

world-class results like the companies mentioned in <a href="index.html#world_class_delivery">What world-class software delivery looks like</a>, who are able to deploy thousands of times

per day.</p>

</div>

<div class="paragraph">

<p>Here&#8217;s the outline for this post:</p>

</div>

<div class="ulist">

<ul>

<li>

<p>Version control</p>

</li>

<li>

<p>Build system</p>

</li>

<li>

<p>Automated testing</p>

</li>

</ul>

</div>

<div class="sect2">

<h2 id="_version_control">Version control</h2>

<div class="paragraph">

<p>A <em>version control system (VCS)</em> is a tool that allows you to store source code, share it with your team, integrate

your work together, and track changes over time. I cannot imagine developing software without using a VCS. It&#8217;s a

central part of every modern SDLC. And there&#8217;s nothing modern about it: nearly 25 years ago, using version control was

item #1 on the <a href="https://www.joelonsoftware.com/2000/08/09/the-joel-test-12-steps-to-better-code/">Joel Test</a> (a quick

test you can use to rate the quality of a software team), and the first version control system was developed roughly 50

years ago.</p>

</div>

<div class="paragraph">

<p>Despite all that, I still come across a surprising number of developers who don&#8217;t know how or why to use version

control. If you&#8217;re one of these developers, it&#8217;s nothing to be ashamed of, and you&#8217;ll find that if you take a small

amount of time to learn it now, it&#8217;s one of those skills that will benefit you for years to come.</p>

</div>

<div class="paragraph">

<p>Here&#8217;s what the next few sections will cover:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Version control primer</dt>

<dd>

<p>A quick intro to version control concepts.</p>

</dd>

<dt class="hdlist1">Example: a crash course on Git</dt>

<dd>

<p>Get hands-on practice using version control by learning to work with Git.</p>

</dd>

<dt class="hdlist1">Example: store your code in GitHub</dt>

<dd>

<p>Get even more hands-on practice using version control by learning to push your

Git repo to GitHub.</p>

</dd>

<dt class="hdlist1">Version control best practices</dt>

<dd>

<p>Learn how to write good commit messages, keep your codebase consistent, review code

to catch bugs and spread knowledge, and ensure your version control system is protected against common security

threats.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>If you&#8217;re already familiar with version control and Git, feel free to skip the next two sections. However, I recommend

you still go through the third section with the GitHub example, as many of the subsequent examples in the

blog post series build on top of GitHub (e.g., using GitHub actions for CI / CD in <a href="06.html#how_to_set_up_ci_cd">Part 5</a>).</p>

</div>

<div class="sect3">

<h3 id="_version_control_primer">Version control primer</h3>

<div class="paragraph">

<p>Have you ever written an essay in Microsoft Word? Maybe you start with a file called <em>essay.doc</em>, but then you realize

you need to do some pretty major changes, so you create <em>essay-v2.doc</em>; then you decide to remove some big pieces, but

you don&#8217;t want to lose them, so you put those in <em>essay-backup.doc</em>, and move the remaining work to <em>essay-v3.doc</em>;

maybe you work on the essay with your friend Anna, so you email her a copy, and she starts making edits; at some point,

she emails you back the doc with her updates, which you then manually combine with the work you&#8217;ve been doing, and save

that under the new name <em>essay-v4-anna-edit.doc</em>; you keep emailing back and forth, and you keep renaming the file,

until minutes before the deadline, you finally submit a file called something like

<em>essay-final-no-really-definitely-final-revision3-v58.doc</em>.</p>

</div>

<div class="paragraph">

<p>Believe it or not, what you&#8217;re doing is essentially version control. You could represent it with the diagram shown in

<a href="05.html#vcs_word">Figure 28</a>:</p>

</div>

<div id="vcs_word" class="imageblock">

<div class="content">

<img src="images/ch4/vcs-word.png" alt="Visualizing your process with Word documents as version control">

</div>

<div class="title">Figure 28. Visualizing your process with Word documents as version control</div>

</div>

<div class="paragraph">

<p>You start with <em>essay.doc</em>, and after some major edits, you <em>commit</em> your changes to a new revision called

<em>essay-v2.doc</em>. Then, you realize that you need to break off in a new direction, so you could say that you&#8217;ve created

a new <em>branch</em> from you original work, and in that new branch, you commit another new revision called <em>essay-v3.doc</em>.

When you email Anna <em>essay-v3.doc</em>, and she starts her work, you could say that she&#8217;s working in yet another branch.

When she emails you back, you manually <em>merge</em> the work in your branch and her branch together to create

<em>essay-v4-anna-edit.doc</em>.</p>

</div>

<div class="paragraph">

<p>What you&#8217;ve just seen is the essence of version control: commits, branches, and merges. Admittedly, manually

emailing and renaming Word docs isn&#8217;t a very good version control system, but it is version control!</p>

</div>

<div class="paragraph">

<p>A better solution would be to use a first-class VCS, which can perform these operations more effectively. The

basic idea with a VCS is as follows:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Repositories</dt>

<dd>

<p>You store files (code, documents, images, etc.) in a <em>repository</em> (<em>repo</em> for short).</p>

</dd>

<dt class="hdlist1">Branches</dt>

<dd>

<p>You start with everything in a single branch, often called something like <code>main</code>. At any time, you can

create a new branch from any existing branch, and work in your own branch independently.</p>

</dd>

<dt class="hdlist1">Commits</dt>

<dd>

<p>Within any branch, you can edit files, and when you&#8217;re ready to store your progress in a new revision, you

create a commit with your updates. The commit typically records not only the changes to the files, but also who made

the changes, and a <em>commit message</em> that describes the changes.</p>

</dd>

<dt class="hdlist1">Merges</dt>

<dd>

<p>At any time, you can merge branches together. For example, it&#8217;s common to create a branch from <code>main</code>, work

in that branch for a while, and then merge your changes back into <code>main</code>.</p>

</dd>

<dt class="hdlist1">Conflicts</dt>

<dd>

<p>VCS tools can merge some types of changes completely automatically, but if there is a <em>conflict</em> (e.g.,

two people changed the same line of code in different ways), the VCS will ask you to <em>resolve</em> the conflict manually.</p>

</dd>

<dt class="hdlist1">History</dt>

<dd>

<p>The VCS tracks every commit in every branch in a <em>commit log</em>, which lets you see the full history of how

the code changed, including all previous revisions of every file, what changed between each revision, and who made

each change.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>Learning about all these terms and concepts is useful, but really, the best way to understand version control is to try

it out, as in the next section.</p>

</div>

</div>

<div class="sect3">

<h3 id="_example_a_crash_course_on_git">Example: a crash course on Git</h3>

<div class="paragraph">

<p>There have been many version control systems developed over the years, including <a href="https://cvs.nongnu.org/">CVS</a>,

<a href="https://subversion.apache.org/">Subversion</a>, <a href="https://www.perforce.com/">Perforce</a>, and

<a href="https://www.mercurial-scm.org/">Mercurial</a>, but these days, the most popular, by far, is <a href="https://git-scm.com/">Git</a>.

According to the <a href="https://survey.stackoverflow.co/2022/">2022 StackOverflow Developer Survey</a>, 93% of developers

use Git (96% if you look solely at professional developers). So if you&#8217;re going to learn one VCS, it should be Git.</p>

</div>

<div class="sect4">

<h4 id="_example_git_basics">Example: Git basics</h4>

<div class="paragraph">

<p>If you don&#8217;t have it already installed, <a href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git">follow these

docs</a> to install Git on your computer. Next, let Git know your name and email:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git config --global user.name "&lt;YOUR NAME&gt;"

$ git config --global user.email "&lt;YOUR EMAIL&gt;"</pre>

</div>

</div>

<div class="paragraph">

<p>Create a new, empty folder on your computer just for experimenting with Git. For example, you could create a folder

called <em>git-practice</em> within the system temp folder:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ mkdir /tmp/git-practice

$ cd git-practice</pre>

</div>

</div>

<div class="paragraph">

<p>Within the <em>git-practice</em> folder, write some text to a file called <em>example.txt</em>:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ echo 'Hello, World!' &gt; example.txt</pre>

</div>

</div>

<div class="paragraph">

<p>It would be nice to have some version control for this file. With Git, that&#8217;s easy. You can turn any folder into a Git

repo by running <code>git init</code>:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git init

Initialized empty Git repository in /tmp/git-practice/.git/</pre>

</div>

</div>

<div class="paragraph">

<p>The contents of your folder should now look something like this:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ tree -aL 1

.

├── .git

└── example.txt</pre>

</div>

</div>

<div class="paragraph">

<p>You should see your original <em>example.txt</em> file, plus a new <em>.git</em> folder. This <em>.git</em> folder is where Git will record

all the information about your branches, commits, revisions, and so on.</p>

</div>

<div class="paragraph">

<p>At any time, you can run the <code>git status</code> command to see the status of your repo:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git status

On branch main



No commits yet



Untracked files:

  (use "git add &lt;file&gt;..." to include in what will be committed)

	example.txt</pre>

</div>

</div>

<div class="paragraph">

<p>The <code>status</code> command is something you&#8217;ll run often, as it gives you several useful pieces of information:</p>

</div>

<div class="ulist">

<ul>

<li>

<p>It tells you that you&#8217;re on a branch called <code>main</code>. This is the default branch when you create a new repo.</p>

</li>

<li>

<p>It tells you what commits there have been. You haven&#8217;t made any commits yet, so Git tells you this.</p>

</li>

<li>

<p>It also tells you if there are any local changes to files that haven&#8217;t been committed yet.</p>

</li>

</ul>

</div>

<div class="paragraph">

<p>To commit your changes, you first need to add the file(s) you want to commit to the <em>staging area</em> using <code>git add</code>:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git add example.txt</pre>

</div>

</div>

<div class="paragraph">

<p>Try running <code>git status</code> one more time:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git status

On branch main



No commits yet



Changes to be committed:

  (use "git rm --cached &lt;file&gt;..." to unstage)

	new file:   example.txt</pre>

</div>

</div>

<div class="paragraph">

<p>Now you can see that <em>example.txt</em> is in the staging area, ready to be committed. To commit the changes, use the

<code>git commit</code> command, passing in a description of the commit to the <code>-m</code> flag:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git commit -m "Initial commit"</pre>

</div>

</div>

<div class="paragraph">

<p>Git is now storing <em>example.txt</em> in its commit log. You can see this by running <code>git log</code>:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git log

commit 7a536b3367981b5c86f22a27c94557412f3d915a (HEAD -&gt; main)

Author: Yevgeniy Brikman

Date:   Sat Apr 20 16:01:28 2024 -0400



    Initial commit</pre>

</div>

</div>

<div class="paragraph">

<p>For each commit in the log, you&#8217;ll see the commit ID, author, date, and commit message. Take special note of the

<em>commit ID</em>: each commit has a different ID that you can use to uniquely identify that commit, and many Git commands

take a commit ID as an argument. Under the hood, a commit ID is calculated by taking the SHA-1 hash of the contents of

the commit, all the commit metadata (author, date, and so on), and the ID of the previous commit. Calculating the ID

this way gives Git a lot of its power.<sup class="footnote">[<a id="_footnoteref_31" class="footnote" href="13-footnotes.html#_footnotedef_31" title="View footnote.">31</a>]</sup> Commit IDs are 40 characters long, but in most commands, you can use just the first 7 characters, as that will

be unique enough to identify commits in all but the largest repos.</p>

</div>

<div class="paragraph">

<p>Let&#8217;s make another commit. First, make a change to <em>example.txt</em>:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ echo 'New line of text' &gt;&gt; example.txt</pre>

</div>

</div>

<div class="paragraph">

<p>This adds a second line of text to <em>example.txt</em>. Run <code>git status</code> once again:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git status

On branch main

Changes not staged for commit:

  (use "git add &lt;file&gt;..." to update what will be committed)

  (use "git restore &lt;file&gt;..." to discard changes in working directory)

	modified:   example.txt</pre>

</div>

</div>

<div class="paragraph">

<p>Now Git is telling you that it sees changes locally, but these changes have not been added to the staging area. To see

what these changes are, run <code>git diff</code>:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git diff

diff --git a/example.txt b/example.txt

index 8ab686e..3cee8ec 100644

--- a/example.txt

+++ b/example.txt

@@ -1 +1,2 @@

 Hello, World!

+New line of text</pre>

</div>

</div>

<div class="paragraph">

<p>You should use <code>git diff</code> frequently to check what changes you&#8217;ve made before committing them. If the changes look good,

use <code>git add</code> to stage the changes and <code>git commit</code> to commit them:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git add example.txt

$ git commit -m "Add another line to example.txt"</pre>

</div>

</div>

<div class="paragraph">

<p>Now, try <code>git log</code> once more:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>commit c4ff96d7c9ae4d916c3a85aeb8722107a57a1426 (HEAD -&gt; main)

Author: Yevgeniy Brikman

Date:   Sat Apr 20 16:12:01 2024 -0400



    Add another line to example.txt



commit 7a536b3367981b5c86f22a27c94557412f3d915a

Author: Yevgeniy Brikman

Date:   Sat Apr 20 16:01:28 2024 -0400



    Initial commit</pre>

</div>

</div>

<div class="paragraph">

<p>Now you can see both of your commits, including their commit messages. This commit log is very powerful:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Debugging</dt>

<dd>

<p>If something breaks in your code, the first question you typically ask is, "what changed?" The commit

log gives you an easy way to answer that question.</p>

</dd>

<dt class="hdlist1">Reverting</dt>

<dd>

<p>You can use <code>git revert &lt;ID&gt;</code> to automatically create a new commit that reverts all the changes

in the commit with ID <code>&lt;ID&gt;</code>, thereby undoing the changes in that commit, while still preserving your Git history.

Or you can use <code>git reset --hard &lt;ID&gt;</code> to get rid of all commits after <code>&lt;ID&gt;</code> entirely, including removing them

from history (use with care!).</p>

</dd>

<dt class="hdlist1">Comparison</dt>

<dd>

<p>You can use <code>git diff</code> to compare not only local changes, but also to compare any two commits. This

lets you see how the code evolved, one commit at a time.</p>

</dd>

<dt class="hdlist1">Author</dt>

<dd>

<p>You can use <code>git blame</code> to annotate each line of a file with information about the last commit that

modified that file, including the date, the commit message, and the author. Although you could use this to blame

someone for causing a bug, as the name implies, the more common use case is to help you understand where any give

piece of code came from, and why that change was made.</p>

</dd>

</dl>

</div>

</div>

<div class="sect4">

<h4 id="_example_git_branching_and_merging">Example: Git branching and merging</h4>

<div class="paragraph">

<p>So far, all of your commits have been on the default branch (<code>main</code>), but in real-world usage, you typically do work

across multiple branches. To create a new branch, use the <code>git checkout</code> command:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git checkout -b testing

Switched to a new branch 'testing'</pre>

</div>

</div>

<div class="paragraph">

<p>To see if it worked, you can use <code>git status</code>, as always:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git status

On branch testing

nothing to commit, working tree clean</pre>

</div>

</div>

<div class="paragraph">

<p>You can also use the <code>git branch</code> command at any time to see what branches are available and which one you&#8217;re on:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$  git branch

  main

* testing</pre>

</div>

</div>

<div class="paragraph">

<p>Any changes you commit now will go into the <code>testing</code> branch. To try this out, modify <em>example.txt</em> once again:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ echo 'Third line of text' &gt;&gt; example.txt</pre>

</div>

</div>

<div class="paragraph">

<p>Next, stage and commit your changes:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git add example.txt

$ git commit -m "Added a 3rd line to example.txt"</pre>

</div>

</div>

<div class="paragraph">

<p>If you use <code>git log</code>, you&#8217;ll see your three commits:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git log

commit c85c2bf93a57cab0a1c3374ea511ef549f1d6496 (HEAD -&gt; testing)

Author: Yevgeniy Brikman

Date:   Sat Apr 20 16:23:27 2024 -0400



    Added a 3rd line to example.txt



commit c4ff96d7c9ae4d916c3a85aeb8722107a57a1426 (main)

Author: Yevgeniy Brikman

Date:   Sat Apr 20 16:12:01 2024 -0400



    Add another line to example.txt



commit 7a536b3367981b5c86f22a27c94557412f3d915a

Author: Yevgeniy Brikman

Date:   Sat Apr 20 16:01:28 2024 -0400



    Initial commit</pre>

</div>

</div>

<div class="paragraph">

<p>But that third commit is <em>only</em> in the <code>testing</code> branch. You can see this by using <code>git checkout</code> to switch back to the

<code>main</code> branch:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git checkout main

Switched to branch 'main'</pre>

</div>

</div>

<div class="paragraph">

<p>Check the contents of <em>example.txt</em>. It&#8217;ll have only two lines! And if you run <code>git log</code>, it&#8217;ll have only two commits.

So each branch gives you a copy of all the files in the repo, and you can modify them in that branch, in isolation, as

much as you want, without affecting any other branches.</p>

</div>

<div class="paragraph">

<p>Of course, working forever in isolation doesn&#8217;t usually make sense. You eventually will want to merge your work back

together. One way to do that with Git is to run <code>git merge</code>:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git merge testing

Updating c4ff96d..c85c2bf

Fast-forward

 example.txt | 1 +

 1 file changed, 1 insertion(+)</pre>

</div>

</div>

<div class="paragraph">

<p>You can see that Git was able to merge all the changes automatically, as there were no conflicts between the <code>main</code> and

<code>testing</code> branches. If you now check the contents of <em>example.txt</em>, it should have three lines in it, and if you run

<code>git log</code>, you&#8217;ll see three commits.</p>

</div>

<div class="admonitionblock tip">

<table>

<tr>

<td class="icon">

<div class="title">Tip</div>

</td>

<td class="content">

<div class="title">Get your hands dirty</div>

<div class="paragraph">

<p>Here are a few exercises you can try at home to get a better feel for using Git:</p>

</div>

<div class="ulist">

<ul>

<li>

<p>Learn how to use the <code>git tag</code> command to create tags.</p>

</li>

<li>

<p>Learn to use <code>git rebase</code>. When does it make sense to use it instead of <code>git merge</code>?</p>

</li>

</ul>

</div>

</td>

</tr>

</table>

</div>

<div class="paragraph">

<p>Now that you know how to run Git locally, on your own computer, you&#8217;ve already learned something useful: if nothing

else, you now have a way to store revisions of your work that&#8217;s much more effective than <em>essay-v2.doc</em>,

<em>essay-v3.doc</em>, etc. But to see the full power of Git, you&#8217;ll want to use it with others, which is the focus of the

next section.</p>

</div>

</div>

</div>

<div class="sect3">

<h3 id="example_store_code_github">Example: store your code in GitHub</h3>

<div class="paragraph">

<p>Git is a <em>distributed VCS</em>, which means that every team member can have a full copy of the repository, and do commits,

merges, and branches, completely locally. However, the most common way to use Git is to pick one copy of the repository

as the <em>central repository</em> that will act as your <em>source of truth</em>. This central repo is the one everyone will

initially get their code from, and as you make changes, you always push them back to this central repo.</p>

</div>

<div class="paragraph">

<p>There are many ways to run such a central repo: the most common approach is to use a hosting service. These not

only host Git repos for you, but they also provide a number of other useful features, such as web UIs, user management,

development workflows, issue tracking, security tools, and so on. The most popular hosting services for Git are

<a href="https://github.com/">GitHub</a>, <a href="https://gitlab.com/">GitLab</a>, and <a href="https://bitbucket.org/">BitBucket</a>. Of these, GitHub is

the most popular by far.</p>

</div>

<div class="paragraph">

<p>In fact, you could argue that GitHub is what made Git popular. GitHub provided a great experience for hosting repos and

collaborating with team members, and it has become the de facto home for most open source projects. So if you wanted

to use or participate in open source, you often had to learn to use Git, and before you knew it, Git and GitHub were

the dominant players in the market. Therefore, it&#8217;s a good idea to learn to use not only Git, but GitHub as well.</p>

</div>

<div class="paragraph">

<p>Let&#8217;s push the example code you&#8217;ve worked on while reading this blog post series to GitHub. Go into the folder where

you have your code:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ cd fundamentals-of-devops</pre>

</div>

</div>

<div class="paragraph">

<p>If you&#8217;ve done all the examples up to this point, the contents of this folder should look something like this:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ tree -L 2

.

├── ch1

│   ├── ec2-user-data-script

│   └── sample-app

├── ch2

│   ├── ansible

│   ├── bash

│   ├── packer

│   └── tofu

└── ch3

    ├── ansible

    ├── docker

    ├── kubernetes

    ├── packer

    └── tofu</pre>

</div>

</div>

<div class="paragraph">

<p>Turn this into a Git repo by running <code>git init</code>:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git init

Initialized empty Git repository in /fundamentals-of-devops/.git/</pre>

</div>

</div>

<div class="paragraph">

<p>If you run <code>git status</code>, you&#8217;ll see that there are no commits and no files staged for commit:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git status

On branch main



No commits yet



Untracked files:

  (use "git add &lt;file&gt;..." to include in what will be committed)

	ch1/

	ch2/

	ch3/</pre>

</div>

</div>

<div class="paragraph">

<p>Before staging these files, you should create a new file in the root of the repo called <em>.gitignore</em>, with the contents

shown in <a href="05.html#example_gitignore">Example 64</a>:</p>

</div>

<div id="example_gitignore" class="exampleblock">

<div class="title">Example 64. The gitignore file (<em>.gitignore</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="gitignore"># <b class="conum">(1)</b>

*.tfstate

*.tfstate.backup

*.tfstate.lock.info



# <b class="conum">(2)</b>

.terraform



# <b class="conum">(3)</b>

*.key



# <b class="conum">(4)</b>

*.zip



# <b class="conum">(5)</b>

node_modules

coverage</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>The <em>.gitignore</em> file specifies files you do <em>not</em> want Git to track:</p>

</div>

<div class="colist arabic">

<ol>

<li>

<p>OpenTofu state should <em>not</em> be checked into version control. You&#8217;ll learn why not, and the proper way to

store state files in <a href="06.html#how_to_set_up_ci_cd">Part 5</a>.</p>

</li>

<li>

<p>The <em>.terraform</em> folder is used by OpenTofu as a scratch directory and should not be checked in.</p>

</li>

<li>

<p>The Ansible examples in earlier blog posts store SSH private keys locally in <em>.key</em> files. These

are secrets, so they should be stored in an appropriate secret store (as you&#8217;ll learn about in

<a href="08.html#how_to_manage_auth_and_secrets">Part 7</a>), and not in version control.</p>

</li>

<li>

<p>The <code>lambda</code> module from <a href="04.html#how_to_deploy_many_apps">Part 3</a> creates a Zip file automatically. This is a

build artifact and should not be checked in.</p>

</li>

<li>

<p>The <em>node_modules</em> and <em>coverage</em> folders are also scratch directories that should not be checked in. You&#8217;ll learn

more about these folders later in this post.</p>

</li>

</ol>

</div>

<div class="paragraph">

<p>I usually commit the <em>.gitignore</em> file first to ensure I don&#8217;t accidentally commit other files that don&#8217;t belong in

version control:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git add .gitignore

$ git commit -m "Add .gitignore"</pre>

</div>

</div>

<div class="paragraph">

<p>With that done, you can use <code>git add .</code> to stage all the files and folders in your <em>fundamentals-of-devops</em> folder, and

then commit them:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git add .

$ git commit -m "Example code for first few chapters"</pre>

</div>

</div>

<div class="paragraph">

<p>The code is now in a Git repo on your local computer. Let&#8217;s now push it to a Git repo on GitHub.</p>

</div>

<div class="paragraph">

<p>If you don&#8217;t have a GitHub account already, <a href="https://github.com/signup">sign up for one now</a> (it&#8217;s free), and follow the

<a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/about-authentication-to-github#authenticating-with-the-command-line">authenticating on the command line docs</a>

to learn to authenticate to GitHub from your terminal.</p>

</div>

<div class="paragraph">

<p>Next, <a href="https://github.com/new">create a new repository in GitHub</a>, give it a name, make the repo public, and click

"Create repository," as shown in <a href="05.html#create_new_gh_repo">Figure 29</a>:</p>

</div>

<div id="create_new_gh_repo" class="imageblock">

<div class="content">

<img src="images/ch4/create-new-gh-repo.png" alt="Create a new GitHub repo">

</div>

<div class="title">Figure 29. Create a new GitHub repo</div>

</div>

<div class="paragraph">

<p>This will create a new, empty repo for you that looks something like <a href="05.html#new_empty_gh_repo">Figure 30</a>:</p>

</div>

<div id="new_empty_gh_repo" class="imageblock">

<div class="content">

<img src="images/ch4/new-empty-gh-repo.png" alt="A newly created, empty GitHub repo">

</div>

<div class="title">Figure 30. A newly created, empty GitHub repo</div>

</div>

<div class="paragraph">

<p>Copy and paste the <code>git remote add</code> command from that page to add a new <em>remote</em>, which is a Git repository hosted

remotely (i.e., somewhere on the Internet):</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git remote add origin https://github.com/&lt;USERNAME&gt;/&lt;REPO&gt;.git</pre>

</div>

</div>

<div class="paragraph">

<p>The preceding command adds your GitHub repo as a remote named <code>origin</code>: you can name remotes whatever you want, but

<code>origin</code> is the convention for your team&#8217;s central repo, so you&#8217;ll see that used all over the place.</p>

</div>

<div class="paragraph">

<p>Now you can use <code>git push &lt;REMOTE&gt; &lt;BRANCH&gt;</code> to push the code from branch <code>&lt;BRANCH&gt;</code> of your local repo to the remote

named <code>&lt;REMOTE&gt;</code>. So to push your <code>main</code> branch to the GitHub repo you just created, you&#8217;d run the following:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git push origin main</pre>

</div>

</div>

<div class="paragraph">

<p>If you refresh your repo in GitHub, you should now see your code there, as shown in <a href="05.html#gh_repo_with_code">Figure 31</a>:</p>

</div>

<div id="gh_repo_with_code" class="imageblock">

<div class="content">

<img src="images/ch4/gh-repo-with-code.png" alt="Your GitHub repo with code in it">

</div>

<div class="title">Figure 31. Your GitHub repo with code in it</div>

</div>

<div class="paragraph">

<p>Notice how GitHub prompts you to "Add a README" on that page. Adding documentation for your code is always a good idea,

so let&#8217;s do it. Click the green Add a README button, and you&#8217;ll get a code editor where you can write the README in

Markdown, as shown in <a href="05.html#gh_repo_readme">Figure 32</a>:</p>

</div>

<div id="gh_repo_readme" class="imageblock">

<div class="content">

<img src="images/ch4/gh-repo-create-readme.png" alt="Filling in a README for the GitHub repo">

</div>

<div class="title">Figure 32. Filling in a README for the GitHub repo</div>

</div>

<div class="paragraph">

<p>Fill in a reasonable description for the repo and instructions on how to use it and then click the "Commit changes&#8230;&#8203;"

button. GitHub will prompt you for a commit message, so fill one in just like the <code>-m</code> flag on the command-line, and

click the "Commit changes" button. GitHub will commit the changes and then take you back to your repo, where you&#8217;ll be

able to see your README, as shown in <a href="05.html#gh_repo_with_readme">Figure 33</a>:</p>

</div>

<div id="gh_repo_with_readme" class="imageblock">

<div class="content">

<img src="images/ch4/gh-repo-with-readme.png" alt="Your GitHub repo with a README">

</div>

<div class="title">Figure 33. Your GitHub repo with a README</div>

</div>

<div class="paragraph">

<p>Notice that the repo in GitHub now has a <em>README.md</em>, but the copy on your own computer doesn&#8217;t. To get the latest code

onto your computer, run the <code>git pull &lt;REMOTE&gt; &lt;BRANCH&gt;</code> command, where <code>&lt;REMOTE&gt;</code> is the name of the remote to pull

from, and <code>&lt;BRANCH&gt;</code> is the branch to pull:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git pull origin main</pre>

</div>

</div>

<div class="paragraph">

<p>The log output should show you that Git was able to pull the changes in and a summary of what changed, which should

include the new <em>README.md</em> file.</p>

</div>

<div class="paragraph">

<p>Note that if you didn&#8217;t have a copy of the repo locally on your computer at all, you couldn&#8217;t just run <code>git pull</code>.

Instead, you first need to use <em>git clone</em> to checkout the initial copy of the repo (note: you don&#8217;t actually need to

run this command, as you do have a copy of the repo already, but just be aware of this for working with other repos

in the future):</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git clone https://github.com/&lt;USERNAME&gt;/&lt;REPO&gt;</pre>

</div>

</div>

<div class="paragraph">

<p>When you run <code>git clone</code>, Git will check out a copy of the repo <code>&lt;REPO&gt;</code> to a folder called <code>&lt;REPO&gt;</code> in your current

working directory. It&#8217;ll also automatically add the repo&#8217;s URL as a remote named <code>origin</code>.</p>

</div>

<div class="paragraph">

<p>So now you&#8217;ve seen the basic Git workflows:</p>

</div>

<div class="ulist">

<ul>

<li>

<p><code>git clone</code>: Check out a fresh copy of a repo.</p>

</li>

<li>

<p><code>git push origin &lt;BRANCH&gt;</code>: Push changes from your local repo back to the remote repo, so all your other

team members can see your work.</p>

</li>

<li>

<p><code>git pull origin &lt;BRANCH&gt;</code>: Pull changes from the remote repo to your local repo, so you can see the work

of all your other team members.</p>

</li>

</ul>

</div>

<div class="paragraph">

<p>This is the basic workflow, but what you&#8217;ll find is that many teams use a slightly different workflow to push changes:

pull requests. This is the topic of the next section.</p>

</div>

</div>

<div class="sect3">

<h3 id="_example_open_a_pull_request_in_github">Example: open a pull request in GitHub</h3>

<div class="paragraph">

<p>A <em>pull request (PR)</em> is a request to merge one branch into another: in effect, you&#8217;re requesting that someone else

runs <code>git pull</code> on your repo/branch. GitHub popularized the PR workflow as the de facto way to make changes to open

source repos, and these days, many companies use PRs to make changes to private repos as well. The pull request

process is as follows:</p>

</div>

<div class="ulist">

<ul>

<li>

<p>You check out a copy of repo <code>R</code>, create a branch <code>B</code>, and commit your changes to this branch. Note that if you have

write access to repo <code>R</code>, you can create branch <code>B</code> directly in repo <code>R</code>. However, if you don&#8217;t have write access,

which is usually the case if repo <code>R</code> is an open source repo in someone else&#8217;s account, then you first create a

<em>fork</em> of repo <code>R</code>, which is a copy of the repo in your own account, and then you create branch <code>B</code> in your fork.</p>

</li>

<li>

<p>When you&#8217;re done with your work in branch <code>B</code>, you open a pull request against repo <code>R</code>, requesting that the

maintainer of that repo merges your changes from branch <code>B</code> into some branch in repo <code>R</code> (typically <code>main</code>).</p>

</li>

<li>

<p>The owner of repo <code>R</code> then uses GitHub&#8217;s PR UI to review your changes, provide comments and feedback, and

ultimately, decide to either merge the changes in, or close the PR unmerged.</p>

</li>

</ul>

</div>

<div class="paragraph">

<p>Let&#8217;s give it a shot. Create a new branch called <code>update-readme</code> in your repo:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git checkout -b update-readme</pre>

</div>

</div>

<div class="paragraph">

<p>Make a change to the <em>README.md</em> file: for example, add a URL to the end of the file. Run <code>git diff</code> to see what your

changes look like:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git diff

diff --git a/README.md b/README.md

index 843bd01..ad75c5e 100644

--- a/README.md

+++ b/README.md

@@ -1,3 +1,5 @@

 # Fundamentals of DevOps and Software Delivery Examples



 Code examples for the book _Fundamentals of DevOps and Software Delivery_.

+

+https://www.fundamentals-of-devops.com/</pre>

</div>

</div>

<div class="paragraph">

<p>If the changes look good, add and commit them:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git add README.md

$ git commit -m "Add URL to README"</pre>

</div>

</div>

<div class="paragraph">

<p>Next, push your <code>update-readme</code> branch to the remote repo:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ git push origin update-readme</pre>

</div>

</div>

<div class="paragraph">

<p>You should see log output that looks something like this:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>remote:

remote: Create a pull request for 'update-readme' on GitHub by visiting:

remote:      https://github.com/&lt;USERNAME&gt;/&lt;REPO&gt;/pull/new/update-readme

remote:</pre>

</div>

</div>

<div class="paragraph">

<p>In the log output, GitHub conveniently shows you a URL for creating a pull request. Open that URL in your

web browser, and you should see a page that looks like <a href="05.html#gh_pr">Figure 34</a>:</p>

</div>

<div id="gh_pr" class="imageblock">

<div class="content">

<img src="images/ch4/gh-pr.png" alt="Opening a pull request in GitHub">

</div>

<div class="title">Figure 34. Opening a pull request in GitHub</div>

</div>

<div class="paragraph">

<p>Fill in a title and description for the PR, then scroll down to see the changes between your branch and <code>main</code>,

which should be the same ones you saw when running <code>git diff</code>. If those changes look OK, click the "Create pull request"

button, and you&#8217;ll end up on the GitHub PR UI, as shown in <a href="05.html#gh_pr_open">Figure 35</a>:</p>

</div>

<div id="gh_pr_open" class="imageblock">

<div class="content">

<img src="images/ch4/gh-pr-open.png" alt="An open pull request in GitHub">

</div>

<div class="title">Figure 35. An open pull request in GitHub</div>

</div>

<div class="paragraph">

<p>You and all your team members can use this PR page to see the code changes (try clicking the "Files changed" tab

to get a view similar to <code>git diff</code>), discuss the changes, request reviewers, request changes, and so on. And all this

discussion gets stored in GitHub, so if later on, you&#8217;re trying to debug an issue or figure out why some code is the way

it is, these PR pages serve as an invaluable source of history and context. As you&#8217;ll see in <a href="06.html#how_to_set_up_ci_cd">Part 5</a>,

this is also the place where a lot of the CI / CD integration will happen.</p>

</div>

<div class="paragraph">

<p>If the PR looks good, click "Merge pull request," and then "Confirm merge," to merge the changes in.</p>

</div>

</div>

<div class="sect3">

<h3 id="_version_control_best_practices">Version control best practices</h3>

<div class="paragraph">

<p>Now that you understand the basics of version control, let&#8217;s discuss the best practices:</p>

</div>

<div class="ulist">

<ul>

<li>

<p>Always use version control</p>

</li>

<li>

<p>Write good commit messages</p>

</li>

<li>

<p>Commit early and often</p>

</li>

<li>

<p>Use a code review process</p>

</li>

<li>

<p>Protect your code</p>

</li>

</ul>

</div>

<div class="sect4">

<h4 id="_always_use_version_control">Always use version control</h4>

<div class="paragraph">

<p>The single most important best practice with version control is the following:</p>

</div>

<div class="admonitionblock tip">

<table>

<tr>

<td class="icon">

<div class="title">Tip</div>

</td>

<td class="content">

<div class="title">Key takeaway #1</div>

<div class="paragraph">

<p>Always manage your code with a version control system.</p>

</div>

</td>

</tr>

</table>

</div>

<div class="paragraph">

<p>It&#8217;s easy, it&#8217;s cheap or free, and the benefits for software engineering are massive. If you&#8217;re writing code, always

store that code in version control. No excuses.</p>

</div>

</div>

<div class="sect4">

<h4 id="_write_good_commit_messages">Write good commit messages</h4>

<div class="paragraph">

<p>Commit messages are important. When you&#8217;re trying to figure out what caused a bug or an outage, or staring at a

confusing piece of code, <code>git log</code> and <code>git blame</code> can be your best friends—but only if the commit messages are well

written. Good commit messages consist of two ingredients:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Summary</dt>

<dd>

<p>The first line of the message should be a short (less than 50 characters), clear summary of the

change.</p>

</dd>

<dt class="hdlist1">Context</dt>

<dd>

<p>If it&#8217;s a trivial change, a summary line can be enough, but for anything larger, put a new line

after the summary line, and then provide more information to help future coders (including a future you!) understand

the context. In particular, focus on <em>what</em> changed and <em>why</em> it changed, which is context that you can&#8217;t always get

just by reading the code, rather than <em>how</em>, which should be clear from the code itself.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>Here&#8217;s an example of such a commit message:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>Fix bug with search auto complete



A more detailed explaination of the fix, if necessary. Provide

additional context that may not be obvious from just reading the

code.



- Use bullet points

- If appropriate



Fixes #123. Jira #456.</pre>

</div>

</div>

<div class="paragraph">

<p>Just by adding these two simple ingredients, summary and context, will make your commit messages already considerably

better. If you&#8217;re able to follow these two rules consistently, you can level up your commit messages even further by

following the instructions in <a href="https://cbea.ms/git-commit/">How to Write a Good Commit Message</a>. And for especially

large projects and teams, you can also consider adopting <a href="https://www.conventionalcommits.org/">Conventional Commits</a> as

a way to enforce even more structure in your commit messages.</p>

</div>

</div>

<div class="sect4">

<h4 id="_commit_early_and_often">Commit early and often</h4>

<div class="paragraph">

<p>One of the keys to being a more effective programmer is learning how to take a large problem and break it down into

small, manageable parts. As it turns out, one of the keys to using version control more effectively is learning to

break down large changes into small, frequent commits.</p>

</div>

<div class="paragraph">

<p>In fact, there are two ideals to aim for:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Atomic commits</dt>

<dd>

<p>Each commit should do exactly one, small, relatively self-contained thing. You should be able to

describe that thing in one short sentence—which, conveniently, you can use as the commit message summary. If you

can&#8217;t fit everything into one sentence, then the commit is likely doing too many things at once, and should be broken

down into smaller parts. For example, instead of a single, massive commit that implements an entire large feature,

aim for a series of smaller commits, where each one implements some logical slice of that feature: e.g., the backend

logic in one commit, the UI logic in another commit, the search logic in another commit, and so on.</p>

</dd>

<dt class="hdlist1">Atomic PRs</dt>

<dd>

<p>Each pull request does exactly one small, relatively self-contained thing. A single PR can contain

multiple commits, so it&#8217;ll naturally be larger in scope than any one commit, but it should still represent a single

set of <em>cohesive</em> changes: that is, changes that naturally and logically go together. If you find that your PR

contains a list of somewhat unrelated changes, that&#8217;s usually a sign you should break it up into multiple PRs. A

classic example of this is a PR that contains a new feature, but along the way, the author of the PR also fixed a

couple bugs they came across, and refactored a bunch of code. Leaving the code cleaner than how you found it (the Boy

Scout Rule) is a good idea, but for the sanity of the developers who will be reviewing your PR and the commit log,

put each of these changes into its own PR: that is, the refactor should go in one PR, the bug fixes each in their own

PRs, and finally, the new feature in its own PR.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>Atomic commits and atomic PRs are ideals, and sometimes you&#8217;ll fall short of them, but it&#8217;s always a good idea to

strive towards these ideals, as they give you a number of benefits:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">More useful Git history</dt>

<dd>

<p>When you&#8217;re scanning your Git history, commits and PRs that do one thing are easier to understand than those that do

many things.</p>

</dd>

<dt class="hdlist1">Less risk</dt>

<dd>

<p>A commit or PR that makes one atomic change is typically less risky, as it&#8217;s often self-contained enough

that you could revert it, whereas commits and PRs that contain dozens of changes can be harder to revert, and

therefore, riskier to merge in the first place.</p>

</dd>

<dt class="hdlist1">Cleaner mental model</dt>

<dd>

<p>To work in atomic units, you typically have to break the work down ahead of time. This often

produces a cleaner mental model of the problem, and ultimately, better results.</p>

</dd>

<dt class="hdlist1">Easier code reviews</dt>

<dd>

<p>Reviewing small, self-contained changes is easy. Reviewing massive PRs with thousands of lines

of unrelated changes is hard.</p>

</dd>

<dt class="hdlist1">Lower risk of data loss</dt>

<dd>

<p>Doing more frequent commits can be a lifesaver. For example, if you commit (and push) your

changes hourly, then if your laptop dies, it&#8217;s an annoying, but minor loss, whereas if you commit only once every few

days, it&#8217;s a huge setback.</p>

</dd>

<dt class="hdlist1">Less risky refactors</dt>

<dd>

<p>Committing more frequently gives you the ability to quickly and safely explore new directions.

For example, you might try a major refactor, and after many hours of work, realize it&#8217;s not working; if you made small

commits all along the way, you can revert to any previous point instantly, whereas if you didn&#8217;t, you may have to

undo your refactor manually, which is can be more time-consuming and error-prone.</p>

</dd>

<dt class="hdlist1">More frequent integration</dt>

<dd>

<p>As you&#8217;ll see in <a href="06.html#how_to_set_up_ci_cd">Part 5</a>, one of the keys to working effectively as a

team is to integrate your changes together regularly, and this tends to be easier if everyone is doing small,

frequent commits.</p>

</dd>

</dl>

</div>

</div>

<div class="sect4">

<h4 id="_use_a_code_review_process">Use a code review process</h4>

<div class="quoteblock">

<blockquote>

<div class="paragraph">

<p>Every page in this book has been checked over by an editor. Why? Because even if you’re the smartest, most capable,

most experienced writer, you can’t proofread your own work. You’re too close to the concepts, and you’ve rolled the

words around your head for so long you can’t put yourself in the shoes of someone who is hearing them for the first

time. Writing code is no different. In fact, if it’s impossible to write prose without independent scrutiny, surely

it’s also impossible to write code in isolation; code has to be correct to the minutest detail, plus it includes prose

for humans as well!</p>

</div>

</blockquote>

<div class="attribution">

&#8212; Jason Cohen<br>

<cite><em>Making Software: What Really Works, and Why We Believe It</em> by Andy Oram and Greg Wilson (O’Reilly Media)</cite>

</div>

</div>

<div class="paragraph">

<p>Having your code reviewed by someone else is a highly effective way to catch bugs, reducing defect rates by as much as

50-80%.<sup class="footnote">[<a id="_footnoteref_32" class="footnote" href="13-footnotes.html#_footnotedef_32" title="View footnote.">32</a>]</sup> Code reviews

are also an efficient mechanism to spread knowledge, culture, training, and a sense of ownership throughout the team.</p>

</div>

<div class="paragraph">

<p>There are different ways of doing code reviews:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Enforce a pull request workflow</dt>

<dd>

<p>One option is to enforce that all changes are done through pull requests (you&#8217;ll

see a way to do that in the next section), so that the maintainers of each repo can asynchronously review each change

before it gets merged.</p>

</dd>

<dt class="hdlist1">Use pair programming</dt>

<dd>

<p>Another option is to use <em>pair programming</em>, a development technique where two programmers

work together at one computer, with one person as the driver, responsible for writing the code, and the other as the

observer, responsible for reviewing the code and thinking about the program at a higher level (the programmers

regularly switch roles). The result is a constant code review process. It takes some time to get used to

it, but with another developer nearby, you are always focused on how to make it clear what your code is doing, and

you have a second set of eyes to catch bugs. Some companies use pair programming for all their coding, while others

use it on an as-needed basis (e.g., for really complex tasks or ramping up a new hire).</p>

</dd>

<dt class="hdlist1">Use formal inspections</dt>

<dd>

<p>A third option is to schedule a live meeting for a code review where you present the code

to multiple developers, and go through it together, line-by-line. You can&#8217;t do this degree of scrutiny for every line

of code, but for mission critical parts of your systems, this can be a very effective way to catch bugs and get

everyone on the same page.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>Whatever process you pick for code reviews, you should define your code review guidelines up front, so you have a

process that is consistent and repeatable across the entire team: that is, everyone knows what sorts of things to look

for (e.g., automated tests), what sorts of things <em>not</em> to look for (e.g., code formatting, which should be automated),

and how to communicate feedback effectively. For an example, have a look at

<a href="https://google.github.io/eng-practices/review/">Google&#8217;s Code Review Guidelines</a>.</p>

</div>

</div>

<div class="sect4">

<h4 id="protect_your_code">Protect your code</h4>

<div class="paragraph">

<p>For many companies these days, the code you write is your most important asset—your secret sauce. Moreover, it&#8217;s also a

highly sensitive asset: if someone can slip some malicious code into your codebase, it can be devastating, as that will

bypass most other security protections you have in place.</p>

</div>

<div class="paragraph">

<p>Therefore, you should consider enabling the following security measures to protect your code:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Signed commits</dt>

<dd>

<p>By default, Git allows you to set your name and email address to any value you want, as shown in

<a href="05.html#git_spoof_commit">Example 65</a>:</p>

<div id="git_spoof_commit" class="exampleblock">

<div class="title">Example 65. Git allows you to set your username and email to any values you want</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="bash">$ git config user.name &quot;Any name you want&quot;

$ git config user.email &quot;Any email you want&quot;</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Git doesn&#8217;t enforce any checking around these values, so you could make commits pretending to be someone else!

Fortunately, most VCS hosts (GitHub, GitLab, etc.) allow you to enforce <em>signed commits</em> on your repos, where they

reject any commit that doesn&#8217;t have a valid cryptographic signature. Typically, the way that it works is you create a

GPG key, which consists of a public and private key pair. You store the private key on your own computer, where only

you can access it, and you

<a href="https://docs.github.com/en/authentication/managing-commit-signature-verification/signing-commits">configure Git to use

the private key to sign your commits</a>. Next, you upload the public key to your GitHub account, and enable

<a href="https://docs.github.com/en/authentication/managing-commit-signature-verification/about-commit-signature-verification">GitHub&#8217;s commit signature verification</a>,

and then GitHub will use this public key to check that any commit that claims to be from you actually has a valid

signature, rejecting any commits that don&#8217;t.</p>

</div>

</dd>

<dt class="hdlist1">Branch protection</dt>

<dd>

<p>Most VCS hosts (GitHub, GitLab, etc.) allow you to enable <em>branch protection</em>, where you can

enforce certain requirements before code can be pushed to certain branches (e.g., <code>main</code>). For example, you could use

<a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/about-protected-branches">GitHub&#8217;s protected branches</a>

to require that all code changes to the <code>main</code> branch are (a) submitted via pull requests, (b) those pull

requests are reviewed by at least N other developers, and (c) certain checks, such as security scans, pass before

those pull requests can be merged. This way, even if an attacker compromises one of your developer accounts, they

still won&#8217;t be able to get code merged into <code>main</code> without other developers seeing it and security scanners checking

it.</p>

</dd>

</dl>

</div>

</div>

</div>

</div>

<div class="sect2">

<h2 id="_build_system">Build system</h2>

<div class="paragraph">

<p>Most software projects use a <em>build system</em> to automate important operations, such as compiling the code, downloading

dependencies, packaging the app for deployment, running automated tests, and so on. The build system serves the

following key role in software projects:</p>

</div>

<div class="admonitionblock tip">

<table>

<tr>

<td class="icon">

<div class="title">Tip</div>

</td>

<td class="content">

<div class="title">Key takeaway #2</div>

<div class="paragraph">

<p>Use a build system to capture, as code, important operations and knowledge for your project, in a way that can be

used both by developers and automated tools.</p>

</div>

</td>

</tr>

</table>

</div>

<div class="paragraph">

<p>The reality is that for most software projects, you can&#8217;t <em>not</em> have a build system: either you use an off-the-shelf

build system, or you end up creating your own out of ad hoc scripts, duct tape, and glue. I would recommend the former.</p>

</div>

<div class="paragraph">

<p>There are many off-the-shelf build tools out there. Some were originally designed for use with a specific programming

language or framework: for example, <a href="https://github.com/ruby/rake">Rake</a> for Ruby, <a href="https://gradle.org/">Gradle</a> and

<a href="https://maven.apache.org/">Maven</a> for Java, <a href="https://www.scala-sbt.org/">SBT</a> for Scala, and <a href="https://www.npmjs.com/">NPM</a>

for JavaScript (Node.js). There are also some build tools that are largely language agnostic, such as

<a href="https://bazel.build/">Bazel</a>, and the grandaddy of all build systems, <a href="https://www.gnu.org/software/make/">Make</a>.</p>

</div>

<div class="paragraph">

<p>Usually, the language-specific tools will give you the best experience with that language; I&#8217;d only go with the

language-agnostic ones like Bazel in specific circumstances, such as massive teams that use dozens of different

languages in a single repo (and these days, I wouldn&#8217;t recommend Make at all). For the purposes of the

blog post series, since the sample app you&#8217;ve used in previous parts is JavaScript (Node.js), let&#8217;s give

NPM a shot, as per the next section.</p>

</div>

<div class="sect3">

<h3 id="_example_configure_your_build_using_npm">Example: configure your build using NPM</h3>

<div class="admonitionblock note">

<table>

<tr>

<td class="icon">

<div class="title">Note</div>

</td>

<td class="content">

<div class="title">Example Code</div>

<div class="paragraph">

<p>As a reminder, you can find all the code examples in the blog post series&#8217;s <a href="https://github.com/brikis98/fundamentals-of-devops-code">sample

code repo in GitHub</a>.</p>

</div>

</td>

</tr>

</table>

</div>

<div class="paragraph">

<p>Let&#8217;s set up NPM as the build system for the Node.js sample app you&#8217;ve been using throughout the blog post series. Head

into the folder you created for running examples in this series, and create a new subfolder for this

blog post and the sample app:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ cd fundamentals-of-devops

$ mkdir -p ch4/sample-app

$ cd ch4/sample-app</pre>

</div>

</div>

<div class="paragraph">

<p>Copy the <em>app.js</em> file you first saw in <a href="02.html#example_run_sample_app_locally">Section 1.1.1</a> into the <em>sample-app</em> folder. Next,

make sure you have <a href="https://nodejs.org/en/download">Node.js installed</a>, which should also install NPM for you. To use

NPM as a build system, you must first configure the build in a <em>package.json</em> file. You can create this file by hand,

or you can let NPM scaffold out an initial version of this file for you by running <code>npm init</code>:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm init</pre>

</div>

</div>

<div class="paragraph">

<p>NPM will prompt you for information such as the package name, version, description, and so on. You can enter

whatever data you want here, or hit ENTER to accept the defaults. When you&#8217;re done, you should have a <em>package.json</em>

file that looks similar to <a href="05.html#example_npm_package_json">Example 66</a>:</p>

</div>

<div id="example_npm_package_json" class="exampleblock">

<div class="title">Example 66. The generated NPM build file (<em>ch4/sample-app/package.json</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="json">{

  <span style="color:#606"><span style="color:#404">&quot;</span><span>name</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample-app-build</span><span style="color:#710">&quot;</span></span>,

  <span style="color:#606"><span style="color:#404">&quot;</span><span>version</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1.0.0</span><span style="color:#710">&quot;</span></span>,

  <span style="color:#606"><span style="color:#404">&quot;</span><span>description</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Sample app for the book 'Fundamentals of DevOps and Software Delivery'</span><span style="color:#710">&quot;</span></span>,

  <span style="color:#606"><span style="color:#404">&quot;</span><span>scripts</span><span style="color:#404">&quot;</span></span>: {

    <span style="color:#606"><span style="color:#404">&quot;</span><span>test</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">echo </span><span style="color:#b0b">\&quot;</span><span style="color:#D20">Error: no test specified</span><span style="color:#b0b">\&quot;</span><span style="color:#D20"> &amp;&amp; exit 1</span><span style="color:#710">&quot;</span></span>

  }

}</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Most of this initial data is metadata about the project. The part to focus on is the <code>scripts</code> object. NPM has a number

of <a href="https://docs.npmjs.com/cli/v10/using-npm/scripts">built-in commands</a>, such as <code>npm install</code>, <code>npm start</code>, <code>npm test</code>,

and so on. All of these have default behaviors, but in most cases, you can define what these commands should do by

adding them to the <code>scripts</code> block. For example, <code>npm init</code> gives you an initial <code>test</code> command in the <code>scripts</code> block

that just exits with an error; you&#8217;ll change this value later in the blog post, when we discuss

automated testing.</p>

</div>

<div class="paragraph">

<p>For now, update the <code>scripts</code> block with a <code>start</code> command, which will define how to start your app, as shown in

<a href="05.html#example_npm_package_json_start">Example 67</a>:</p>

</div>

<div id="example_npm_package_json_start" class="exampleblock">

<div class="title">Example 67. Add a start command to the scripts block (<em>ch4/sample-app/package.json</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="json">  <span style="color:#606"><span style="color:#404">&quot;</span><span>scripts</span><span style="color:#404">&quot;</span></span>: {

    <span style="color:#606"><span style="color:#404">&quot;</span><span>start</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">node app.js</span><span style="color:#710">&quot;</span></span>,

  },</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Now you can use the <code>npm start</code> command to run your app:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm start



&gt; sample-app@1.0.0 start

&gt; node app.js



Listening on port 8080</pre>

</div>

</div>

<div class="paragraph">

<p>Being able to use <code>npm start</code> over <code>node app.js</code> may not seem like much of a win, but there&#8217;s a big difference:

<code>npm start</code> is a <em>well-known convention</em>. Most Node.js and NPM users know to use <code>npm start</code> on a project. Most tools

that work with Node.js know about it as well: e.g., if you had this <em>package.json</em> with a <code>start</code> command back in

<a href="02.html#how_to_deploy_your_app">Part 1</a>, Fly.io would&#8217;ve automatically used it to start the app, without you having to tell it what

command to run.</p>

</div>

<div class="paragraph">

<p>You might know to run <code>node app.js</code> to start this app, but the other members of your team might not—especially as the

project grows larger, and instead of a single  <em>app.js</em> file, there are thousands of source files, and it&#8217;s not

obvious which one to run. You could document the command in a README, but there&#8217;s a good risk it&#8217;ll go out of date.

By capturing this in your build system, which you run regularly, you are capturing this information in a way that is

more likely to be kept up-to-date. And as a bonus, you&#8217;re capturing in a way that both other developers (humans) and

other tools (automation) can leverage.</p>

</div>

<div class="paragraph">

<p>Of course, <code>start</code> isn&#8217;t the only command you would add. The idea would be to add all the common operations on your

project to the build. For example, in <a href="04.html#example_docker_crash_course">Section 3.4.1.1</a>, you created a <em>Dockerfile</em> to package the app as

a Docker image, and in order to build that Docker image for multiple CPU architectures (e.g., ARM64, AMD64), you had to

use a relatively complicated <code>docker buildx</code> command. This is a great thing to capture in your build.</p>

</div>

<div class="paragraph">

<p>First, copy the <em>Dockerfile</em> shown in <a href="05.html#example_npm_dockerfile">Example 68</a> into the <em>sample-app</em> folder:</p>

</div>

<div id="example_npm_dockerfile" class="exampleblock">

<div class="title">Example 68. Updated Dockerfile for the app (<em>ch4/sample-app/Dockerfile</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="dockerfile">FROM node:21.7



WORKDIR /home/node/app



# <b class="conum">(1)</b>

COPY package.json .

COPY app.js .



EXPOSE 8080



USER node



# <b class="conum">(2)</b>

CMD [&quot;npm&quot;, &quot;start&quot;]</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>This is identical to the <em>Dockerfile</em> you saw in <a href="04.html#example_docker_crash_course">Section 3.4.1.1</a>, except for two changes:</p>

</div>

<div class="colist arabic">

<ol>

<li>

<p>Copy the <em>package.json</em> file into the Docker image, in addition to <em>app.js</em>.</p>

</li>

<li>

<p>Use <code>npm start</code> to start the app, rather than hard-code <code>node app.js</code>. This way, if you ever change how you run the

app—which you will later in this blog post—the only thing you&#8217;ll need to update is <em>package.json</em>.</p>

</li>

</ol>

</div>

<div class="paragraph">

<p>Next, add a <code>dockerize</code> command to the <code>scripts</code> block in <em>package.json</em>, as shown in

<a href="05.html#example_npm_package_json_docker_build">Example 69</a>:</p>

</div>

<div id="example_npm_package_json_docker_build" class="exampleblock">

<div class="title">Example 69. Add a <code>dockerize</code> command to the scripts block (<em>ch4/sample-app/package.json</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="json">  <span style="color:#606"><span style="color:#404">&quot;</span><span>scripts</span><span style="color:#404">&quot;</span></span>: {

    <span style="color:#606"><span style="color:#404">&quot;</span><span>start</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">node app.js</span><span style="color:#710">&quot;</span></span>,

    <span style="color:#606"><span style="color:#404">&quot;</span><span>dockerize</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">docker buildx build --platform=linux/amd64,linux/arm64 -t sample-app:$(npm pkg get version | tr -d '</span><span style="color:#b0b">\&quot;</span><span style="color:#D20">') .</span><span style="color:#710">&quot;</span></span>,

  },</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Notice how the <code>dockerize</code> command sets the build tag (the <code>-t</code> flag) to the output of <code>npm pkg get version</code>, which is

an NPM command that will return the value of the <code>version</code> value in <em>package.json</em>. So now your build file is also the

single location where you manage the version of your app.</p>

</div>

<div class="paragraph">

<p>Now, instead of trying to figure out a long, esoteric <code>docker buildx</code> command, members of your team can execute

<code>npm run dockerize</code> (note that you need <code>npm run dockerize</code> and not just <code>npm dockerize</code> as <code>dockerize</code> is custom

command, and not one of the ones built-into NPM):</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm run dockerize



&gt; sample-app@v4 dockerize

&gt; docker buildx build --platform=linux/amd64,linux/arm64 -t sample-app:$(npm pkg get version | tr -d '"') .



[+] Building 0.5s (14/14) FINISHED

 =&gt; [internal] load build definition from Dockerfile

(... truncated ...)

 =&gt; [linux/amd64 4/4] COPY app.js .

 =&gt; [linux/arm64 4/4] COPY app.js .</pre>

</div>

</div>

</div>

<div class="sect3">

<h3 id="_dependency_management">Dependency management</h3>

<div class="paragraph">

<p>One of the key responsibilities of a build system is to help you manage your <em>dependencies</em>: that is, other software

packages and libraries that your code uses. There are many kinds of dependencies:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Code in the same repo</dt>

<dd>

<p>You may choose to break up the code in a single repo into multiple modules or packages

(depending on the programming language you&#8217;re using), and to have these modules depend on each other. This lets you

develop different parts of your codebase in isolation from the others, possibly with completely separate teams

working on each part.</p>

</dd>

<dt class="hdlist1">Code in different repos</dt>

<dd>

<p>Your company may store code across multiple repos. This gives you even more isolation

between the different parts of your software and makes it even easier for separate teams to take ownership for each

part. Typically, when repo A depends on code in repo B, you depend on a specific version of that code. This version

may correspond to a specific Git tag, or it could depend on a versioned <em>artifact</em> published from that repo: e.g., a

Jar file in the Java world or a Ruby Gem in the Ruby world.</p>

</dd>

<dt class="hdlist1">Open source code</dt>

<dd>

<p>Perhaps the most common type of dependency these days is a dependency on open source code. The

<a href="https://www.synopsys.com/software-integrity/open-source-security-risk-analysis-report.html">2024 Open Source Security

and Risk Analysis Report</a> by Synopsis found that 96% of codebases rely on open source and that 70% of all the code

in those codebases originates from open source! The open source code almost always lives in separate repos, so again,

you&#8217;ll typically depend on a specific version of that code.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>Whatever type of dependency you have, there&#8217;s a common theme here: you use a dependency so that you can rely on someone

else to solve certain problems for you, instead of having to solve everything yourself from scratch (and maintain it

all). If you want to maximize that leverage, then here&#8217;s a key rule:</p>

</div>

<div class="admonitionblock tip">

<table>

<tr>

<td class="icon">

<div class="title">Tip</div>

</td>

<td class="content">

<div class="title">Key takeaway #3</div>

<div class="paragraph">

<p>Use a dependency management tool to pull in dependencies—not copy &amp; paste.</p>

</div>

</td>

</tr>

</table>

</div>

<div class="paragraph">

<p>Why not copy &amp; paste? If you copy &amp; paste a dependency, you run into a variety of problems:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Transitive dependencies</dt>

<dd>

<p>Copy/pasting a single dependency is easy, but if that dependency has its own dependencies,

and those dependencies have their own dependencies, and so on (collectively known as <em>transitive dependencies</em>),

then copy/pasting becomes rather hard.</p>

</dd>

<dt class="hdlist1">Licensing</dt>

<dd>

<p>Copy/pasting may violate the license terms of that dependency, especially if you end up modifying that

code because it now sits in your own repo. Be especially aware of dependencies that uses GPL-style licenses (known as

<em>copyleft</em> or <em>viral</em> licenses), for if you modify the code in those dependencies, that may trigger a clause in the

license that requires you to release your own code under the same license (i.e., you&#8217;ll be forced to open source your

company&#8217;s proprietary code!).</p>

</dd>

<dt class="hdlist1">Staying up to date</dt>

<dd>

<p>If you copy/paste the code, to get any future updates, you&#8217;ll have to copy/paste new code, and

new transitive dependencies, and make sure you don&#8217;t lose any changes your team members made along the way.</p>

</dd>

<dt class="hdlist1">Private APIs</dt>

<dd>

<p>You may end up using private APIs (since you can access those files locally) instead of the public

ones that were actually designed to be used, which can lead to unexpected behavior, and make staying up to date even

harder.</p>

</dd>

<dt class="hdlist1">Bloating your repo</dt>

<dd>

<p>Every dependency you copy/paste into your version control system makes it larger and slower.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>The proper way to use dependencies is with a <em>dependency management tool</em>. Most build systems have dependency management

tools built in, and the way they typically work is you define your dependencies as code, in the build configuration,

including the version of the dependency you&#8217;re using, and the dependency management tool is then responsible for

downloading that dependency, plus any transitive dependencies, and making it available to your code.</p>

</div>

<div class="paragraph">

<p>Let&#8217;s try out an example with the Node.js sample app and NPM.</p>

</div>

</div>

<div class="sect3">

<h3 id="_example_add_dependencies_in_npm">Example: add dependencies in NPM</h3>

<div class="paragraph">

<p>So far, the Node.js sample app you&#8217;ve been using has not had any dependencies other than the <code>http</code> standard library

built into Node.js itself. Although you can build web apps this way, the more common approach is to use some sort of

web framework. For example, <a href="https://expressjs.com/">Express</a> is a popular web framework for Node.js. To use it,

you can run:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm install express --save</pre>

</div>

</div>

<div class="paragraph">

<p>If you look into <em>package.json</em>, you will now have a new <code>dependencies</code> section, as shown in

<a href="05.html#example_npm_package_json_dependencies">Example 70</a>:</p>

</div>

<div id="example_npm_package_json_dependencies" class="exampleblock">

<div class="title">Example 70. NPM managed dependencies (<em>ch4/sample-app/package.json</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="json">  <span style="color:#606"><span style="color:#404">&quot;</span><span>dependencies</span><span style="color:#404">&quot;</span></span>: {

    <span style="color:#606"><span style="color:#404">&quot;</span><span>express</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">^4.19.2</span><span style="color:#710">&quot;</span></span>

  }</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>You should also see two other changes in the folder with the <em>package.json</em> file:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1"><em>node_modules</em></dt>

<dd>

<p>This is a scratch directory where NPM downloads dependencies. This folder should be in your

<em>.gitignore</em> file so you do <em>not</em> check it into version control. Instead, whenever anyone checks out the repo the

first time, they can run <code>npm install</code>, and NPM will install all the dependencies they need automatically.</p>

</dd>

<dt class="hdlist1"><em>package-lock.json</em></dt>

<dd>

<p>This is a <em>dependency lock file</em>: it captures the <em>exact</em> dependencies that were installed.

This is useful because in <em>package.json</em>, you can specify a <em>version range</em> instead of a specific version to install.

For example, you may have noticed that <code>npm install</code> set the version of Express to <code>^4.19.2</code>. Note the caret (<code>^</code>) at

the front: this is called a <em>caret version range</em>, and it allows NPM to install any version of Express at 4.x.y

version at or above 4.19.2 (but not, for example, 5.0.0). So every time you run <code>npm install</code>, you may get a new

version of Express. This can be a good thing, as you may be picking up bug fixes or security patches. But it can also

be frustrating in an automated environment, as your builds may not be <em>reproducible</em>. With a lock file, you can use

the <code>npm ci</code> command instead of <code>npm install</code> to tell NPM to install the exact versions in the lock file, so the

build output is exactly the same every time. You&#8217;ll see an example of this shortly.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>Now that Express is installed, you can rewrite the code in <em>app.js</em> to use the Express framework, as shown in

<a href="05.html#example_express_app">Example 71</a>:</p>

</div>

<div id="example_express_app" class="exampleblock">

<div class="title">Example 71. The sample app rewritten using the Express framework (<em>ch4/sample-app/app.js</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="javascript">const express = require(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">express</span><span style="color:#710">'</span></span>);



const app = express();

const port = <span style="color:#00D">8080</span>;



app.get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">/</span><span style="color:#710">'</span></span>, (req, res) =&gt; {

  res.send(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Hello, World!</span><span style="color:#710">'</span></span>);

});



app.listen(port, () =&gt; {

  console.log(<span style="color:#F00;background-color:#FAA">`</span>Example app listening on port <span style="color:#369;font-weight:bold">$</span>{port}<span style="color:#F00;background-color:#FAA">`</span>);

});</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>This app listens on port 8080 and responds with "Hello, World!" just as before, but because you&#8217;re using a framework,

it&#8217;ll be a lot easier to evolve this code into a real app by leveraging all the features built into Express: e.g.,

routing, templating, error-handling, middleware, security, and so on.</p>

</div>

<div class="paragraph">

<p>There&#8217;s one more thing you need to do now that the app has dependencies: you need to update the <em>Dockerfile</em> to

install dependencies, as shown in <a href="05.html#example_express_docker">Example 72</a>:</p>

</div>

<div id="example_express_docker" class="exampleblock">

<div class="title">Example 72. Update the Docker file to run <code>npm install</code> (<em>ch4/sample-app/Dockerfile</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="dockerfile">FROM node:21.7



WORKDIR /home/node/app



# <b class="conum">(1)</b>

COPY package.json .

COPY package-lock.json .



# <b class="conum">(2)</b>

RUN npm ci --only=production



COPY app.js .



EXPOSE 8080



USER node



CMD [&quot;npm&quot;, &quot;start&quot;]</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>You need to make two changes to the <em>Dockerfile</em>:</p>

</div>

<div class="colist arabic">

<ol>

<li>

<p>Copy not only <em>package.json</em>, but also <em>package-lock.json</em> into the Docker image.</p>

</li>

<li>

<p>Run <code>npm ci</code>, which, as mentioned earlier, is very similar to <code>npm install</code>, except it&#8217;s designed to do a

<em>clean install</em>, where it installs the exact dependencies in the lock file, without any changes. This is meant to

be used in automated environments, where you want repeatable builds. Note also the use of the <code>--only=production</code>

flag to tell NPM to only install the production dependencies. You can have a <code>devDependencies</code> block on

<em>package.json</em> where you define dependencies only used in the dev environment (e.g., tooling for automated testing,

as you&#8217;ll see in the next section), and there&#8217;s no need to bloat the Docker image with these dependencies.</p>

</li>

</ol>

</div>

<div class="paragraph">

<p>You can now try running <code>npm start</code> to check that the app runs with its use of the Express framework as a dependency,

or <code>npm run dockerize</code> to check that the Docker image still builds correctly.</p>

</div>

<div class="admonitionblock tip">

<table>

<tr>

<td class="icon">

<div class="title">Tip</div>

</td>

<td class="content">

<div class="title">Get your hands dirty: alternative build tools for Node.js</div>

<div class="paragraph">

<p>To avoid introducing too many new tools, I used NPM as a build system in this blog post, as it comes

native with Node.js. However, for production use cases, you may want to try out one of these more modern and robust

build systems:</p>

</div>

<div class="ulist">

<ul>

<li>

<p><a href="https://yarnpkg.com/">Yarn</a></p>

</li>

<li>

<p><a href="https://turbo.build/repo">Turborepo</a></p>

</li>

<li>

<p><a href="https://lerna.js.org/">Lerna</a></p>

</li>

<li>

<p><a href="https://pnpm.io/">PNPm</a></p>

</li>

<li>

<p><a href="https://parceljs.org/">Parcel</a></p>

</li>

</ul>

</div>

</td>

</tr>

</table>

</div>

</div>

</div>

<div class="sect2">

<h2 id="automated_testing">Automated testing</h2>

<div class="paragraph">

<p>Programming can be scary. One of the underappreciated costs of technical debt is the psychological impact it has on

developers. There are thousands of programmers out there who are scared of doing their jobs. Perhaps you&#8217;re one of

them.</p>

</div>

<div class="paragraph">

<p>You get a bug report at three in the morning and after digging around, you isolate it to a tangled mess of spaghetti

code. There is no documentation. The developer who originally wrote the code no longer works at the company. You don&#8217;t

understand what the code is doing. You don&#8217;t know all the places it gets used. What you have here is <em>legacy code</em>.</p>

</div>

<div class="quoteblock">

<blockquote>

<div class="paragraph">

<p>Legacy code. The phrase strikes disgust in the hearts of programmers. It conjures images of slogging through a murky

swamp of tangled undergrowth with leaches beneath and stinging flies above. It conjures odors of murk, slime,

stagnancy, and offal. Although our first joy of programming may have been intense, the misery of dealing with legacy

code is often sufficient to extinguish that flame.</p>

</div>

</blockquote>

<div class="attribution">

&#8212; Michael Feathers<br>

<cite><em>Working Effectively with Legacy Code</em> (Pearson)</cite>

</div>

</div>

<div class="paragraph">

<p>Legacy code is scary. You&#8217;re afraid because you still have scars from the time you tried to fix one bug only to reveal

three more; the "trivial" change that took two months; the tiny performance tweak that brought the whole system down

and pissed off all of your coworkers. So you&#8217;re afraid—of your own codebase. That&#8217;s a tough place to be.</p>

</div>

<div class="paragraph">

<p>Fortunately, there is a solution: <em>automated testing</em>, where you write <em>test code</em> to validate that your <em>production

code</em> works the way you expect it to. The main reason to write automated tests is not that tests prove the

correctness of your code (they don&#8217;t) or that you&#8217;ll catch all bugs with tests (you won&#8217;t), but the following:</p>

</div>

<div class="admonitionblock tip">

<table>

<tr>

<td class="icon">

<div class="title">Tip</div>

</td>

<td class="content">

<div class="title">Key takeaway #4</div>

<div class="paragraph">

<p>Use automated tests to give your team the confidence to make changes quickly.</p>

</div>

</td>

</tr>

</table>

</div>

<div class="paragraph">

<p>The key word is <em>confidence</em>: tests provide a psychological benefit as much as a technical one. If you have a good test

suite, you don&#8217;t have to keep the state of the whole program in your head. You don&#8217;t have to worry about breaking other

people&#8217;s code. You don&#8217;t have to repeat the same boring, error-prone manual testing over and over again. You just run a

single test command and get rapid feedback on whether things are working.</p>

</div>

<div class="paragraph">

<p>There are many types of automated tests:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Compiler</dt>

<dd>

<p>If you&#8217;re using a statically-typed language (e.g., Java, Scala, Haskell, Go, TypeScript), you can

compile the code to automatically identify (a) syntactic issues and (b) type errors. If you&#8217;re using a

dynamically-typed language (e.g., Ruby, Python, JavaScript), you can pass the code through the interpreter to

identify syntactic issues.</p>

</dd>

<dt class="hdlist1">Static analysis / linting</dt>

<dd>

<p>These are tools that read and check your code "statically"—that is, without executing

it—to automatically identify potential issues. Examples: <a href="https://www.shellcheck.net/">ShellCheck</a> for Bash,

<a href="https://eslint.org/">ESLint</a> for JavaScript, <a href="https://spotbugs.github.io/">SpotBugs</a> for Java,

<a href="https://rubocop.org/">RuboCop</a> for Ruby.</p>

</dd>

<dt class="hdlist1">Policy tests</dt>

<dd>

<p>In the last few years, <em>policy as code tools</em> have become more popular as a way to define and enforce

company policies and legal regulations in code. Examples: <a href="https://www.openpolicyagent.org/">Open Policy Agent</a>,

<a href="https://www.hashicorp.com/sentinel">Sentinel</a>, <a href="https://intercept.cc/">Intercept</a>. Many of these tools are based on

static analysis, except they give you flexible languages to define what sorts of rules you want to check. Some rely

on plan testing, as described next.</p>

</dd>

<dt class="hdlist1">Plan tests</dt>

<dd>

<p>Whereas static analysis is a way to test your code without executing it at all, <em>plan testing</em> is a way

to partially execute your code. This typically only applies to tools that can generate an <em>execution plan</em> without

actually executing the code. For example, OpenTofu has a <code>plan</code> command that shows you what changes the code would

make to your infrastructure without actually making those changes: so in effect, you are running all the <em>read</em>

operations of your code, but none of the <em>write</em> operations. You can write automated tests against this sort of plan

output using tools such as <a href="https://www.openpolicyagent.org/">Open Policy Agent</a> and

<a href="https://terratest.gruntwork.io/">Terratest</a>.</p>

</dd>

<dt class="hdlist1">Unit tests</dt>

<dd>

<p>This is the first of the test types that fully execute your code to test it. The idea with unit tests

is to execute only a single "unit" of your code: what a unit is depends on the programming language, but it&#8217;s

typically a small part of the code, such as one function or one class. You typically <em>mock</em> any dependencies outside

of that unit (e.g., databases, other services, the file system), so that the test solely executes the unit in

question. Some programming languages have unit testing tools built in, such as

<a href="https://golang.org/pkg/testing/">testing</a> for Go and <a href="https://docs.python.org/3/library/unittest.html">unittest</a> for

Python, whereas other languages rely on 3rd party tools for unit testing, such as <a href="https://junit.org/junit5/">JUnit</a>

for Java and <a href="https://jestjs.io/">Jest</a> for JavaScript.</p>

</dd>

<dt class="hdlist1">Integration tests</dt>

<dd>

<p>Just because you&#8217;ve tested a unit in isolation and it works, doesn&#8217;t mean that multiple units

will work when you put them together. That&#8217;s where integration testing comes in. Here, you test multiple units of

your code (e.g., multiple functions or classes), often with a mix of real dependencies (e.g., a database) and mocked

dependencies (e.g., a mock remote service).</p>

</dd>

<dt class="hdlist1">End-to-end (E2E) tests</dt>

<dd>

<p>End-to-end tests verify that your entire product works as a whole: that is, your run your

app, all the other services you rely on, all your databases and caches, and so on, and test them all together. These

often overlap with the idea of <em>acceptance tests</em>, which verify your product works from the perspective of the user

or customer ("does the product solve the problem the user cares about").</p>

</dd>

<dt class="hdlist1">Performance tests</dt>

<dd>

<p>Most unit, integration, and E2E tests verify the correctness of a system under ideal conditions:

one user, low system load, and no failures. Performance tests verify the stability and responsiveness of a system in

the face of heavy load and failures.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>Automated tests are how you fight your fear. They are how you fight legacy code. In fact, in the same book I

quoted earlier, Michael Feathers writes, "to me, legacy code is simply code without tests." I don&#8217;t know about you, but

I don&#8217;t want to add more legacy code to this world, so that means it&#8217;s time to write some tests!</p>

</div>

<div class="sect3">

<h3 id="_example_add_automated_tests_for_the_node_js_app">Example: add automated tests for the Node.js app</h3>

<div class="paragraph">

<p>Consider the Node.js sample app you&#8217;ve been using in this blog post, as shown in

<a href="05.html#example_node_js_sample_app_original">Example 73</a>:</p>

</div>

<div id="example_node_js_sample_app_original" class="exampleblock">

<div class="title">Example 73. The Node.js sample app (<em>ch4/sample-app/app.js</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="javascript">const express = require(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">express</span><span style="color:#710">'</span></span>);



const app = express();

const port = <span style="color:#00D">8080</span>;



app.get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">/</span><span style="color:#710">'</span></span>, (req, res) =&gt; {

  res.send(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Hello, World!</span><span style="color:#710">'</span></span>);

});



app.listen(port, () =&gt; {

  console.log(<span style="color:#F00;background-color:#FAA">`</span>Example app listening on port <span style="color:#369;font-weight:bold">$</span>{port}<span style="color:#F00;background-color:#FAA">`</span>);

});</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Stop for a second and ask yourself, how do you know this code actually works? So far, the way you&#8217;ve answered that

question is through <em>manual testing</em>, where you manually ran the app with <code>npm start</code> and checked URLs in your browser.

This works fine for a tiny, simple app, but once the app grows larger (hundreds of URLs to check) and your team grows

larger (hundreds of developers making changes), manual testing will become too time-consuming and error-prone.</p>

</div>

<div class="paragraph">

<p>The idea with automated testing is to write code that performs the testing steps for you, taking advantage of the fact

that computers can perform these checks far faster and more reliably than a person. To get a feel for automated

testing, let&#8217;s start with a very simple example: a unit test. To create a unit test, you need a unit of code.</p>

</div>

<div class="paragraph">

<p>Create a file called <em>reverse.js</em> with the contents shown in <a href="05.html#example_reverse">Example 74</a>:</p>

</div>

<div id="example_reverse" class="exampleblock">

<div class="title">Example 74. Example module that can reverse characters and words in strings (<em>ch4/sample-app/reverse.js</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="javascript">// <b class="conum">(1)</b>

<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">reverseWords</span>(str) {

  <span style="color:#080;font-weight:bold">return</span> str

    .split(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20"> </span><span style="color:#710">'</span></span>)

    .reverse()

    .join(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20"> </span><span style="color:#710">'</span></span>);

}



// <b class="conum">(2)</b>

<span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">reverseCharacters</span>(str) {

  <span style="color:#080;font-weight:bold">return</span> str

    .split(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#710">'</span></span>)

    .reverse()

    .join(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#710">'</span></span>);

}



module.exports = {reverseCharacters, reverseWords};</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>This code contains two functions:</p>

</div>

<div class="colist arabic">

<ol>

<li>

<p><code>reverseWords</code> reverses the words in a string. For example, if you pass in "hello world", you should get back "world

hello".</p>

</li>

<li>

<p><code>reverseCharacters</code> reverses the characters in a string. For example, if you pass in "abcd", you should get back

"dcba".</p>

</li>

</ol>

</div>

<div class="paragraph">

<p>Let me ask the same question again: how do you know this code actually works? I suppose you could stare at the code for

a while, simulate what it does in your head, and declare it as either working or not. But if you&#8217;ve ever written code,

you&#8217;ve written buggy code, so you know that relying on the simulator in your head isn&#8217;t enough. You&#8217;ve got to test the

code.</p>

</div>

<div class="paragraph">

<p>One option is to test the code manually. For example, you could fire up a <em>REPL (read-eval-print-loop)</em>, which is an

interactive shell where you can manually execute code. For Node.js, you can get a REPL by running the <code>node</code> executable

with no arguments:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ node

Welcome to Node.js v21.7.1.

Type ".help" for more information.

&gt;</pre>

</div>

</div>

<div class="paragraph">

<p>You can now type code into this REPL, hit ENTER, and Node.js will execute the and show you the result:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>&gt; 2 + 2

4</pre>

</div>

</div>

<div class="paragraph">

<p>You could use this to test the <code>reverseWords</code> function as follows:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>&gt; const reverse = require('./reverse')

undefined

&gt; reverse.reverseWords('hello world')

'world hello'</pre>

</div>

</div>

<div class="paragraph">

<p>(When you&#8217;re done experimenting with the REPL, use Ctrl+D to exit).</p>

</div>

<div class="paragraph">

<p>Hey, that seems to work! But this is hardly a thorough test, and doing this manually every time is time-consuming and

error-prone. So let&#8217;s capture the steps you did in a REPL in an automated test.</p>

</div>

<div class="paragraph">

<p>First, you need to install some testing libraries: you&#8217;ll use <a href="https://jestjs.io/">Jest</a> as a testing framework and, a

little later on, <a href="https://www.npmjs.com/package/supertest">SuperTest</a> as a library for testing HTTP apps. Use

<code>npm install</code> to add these dependencies, but this time, use the <code>--save-dev</code> flag to save them as dev dependencies;

this way, they&#8217;ll be available during development (where you run tests), but won&#8217;t be packaged into your app for

production deployments (where you don&#8217;t run tests):</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm install --save-dev jest supertest</pre>

</div>

</div>

<div class="paragraph">

<p>This will update <em>package.json</em> with a new <code>devDependencies</code> section, as shown in <a href="05.html#example_npm_package_json_dev_deps">Example 75</a>:</p>

</div>

<div id="example_npm_package_json_dev_deps" class="exampleblock">

<div class="title">Example 75. Your <em>package.json</em> file should now contain dev dependencies (<em>ch4/sample-app/package.json</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="json">{

  <span style="color:#606"><span style="color:#404">&quot;</span><span>dependencies</span><span style="color:#404">&quot;</span></span>: {

    <span style="color:#606"><span style="color:#404">&quot;</span><span>express</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">^4.19.2</span><span style="color:#710">&quot;</span></span>

  },

  <span style="color:#606"><span style="color:#404">&quot;</span><span>devDependencies</span><span style="color:#404">&quot;</span></span>: {

    <span style="color:#606"><span style="color:#404">&quot;</span><span>jest</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">^29.7.0</span><span style="color:#710">&quot;</span></span>,

    <span style="color:#606"><span style="color:#404">&quot;</span><span>supertest</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">^7.0.0</span><span style="color:#710">&quot;</span></span>

  }

}</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Next, update the <code>test</code> command in <em>package.json</em> to run Jest, as shown in <a href="05.html#example_npm_package_json_test">Example 76</a>:</p>

</div>

<div id="example_npm_package_json_test" class="exampleblock">

<div class="title">Example 76. Update the test command to run Jest (<em>ch4/sample-app/package.json</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="json"><span style="color:#606"><span style="color:#404">&quot;</span><span>scripts</span><span style="color:#404">&quot;</span></span>: {

  <span style="color:#606"><span style="color:#404">&quot;</span><span>test</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jest --verbose</span><span style="color:#710">&quot;</span></span>

}</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Now you can start writing tests. Create a file called <em>reverse.test.js</em> with the contents shown in

<a href="05.html#example_reverse_test">Example 77</a>:</p>

</div>

<div id="example_reverse_test" class="exampleblock">

<div class="title">Example 77. Example unit test for the <code>reverseWords</code> function (<em>ch4/sample-app/reverse.test.js</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="javascript">const reverse = require(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">./reverse</span><span style="color:#710">'</span></span>);



describe(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">test reverseWords</span><span style="color:#710">'</span></span>, () =&gt; {                   // <b class="conum">(1)</b>

  test(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">hello world =&gt; world hello</span><span style="color:#710">'</span></span>, () =&gt; {            // <b class="conum">(2)</b>

    const result = reverse.reverseWords(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">hello world</span><span style="color:#710">'</span></span>); // <b class="conum">(3)</b>

    expect(result).toBe(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">world hello</span><span style="color:#710">'</span></span>);                 // <b class="conum">(4)</b>

  });

});</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Here&#8217;s how this code works:</p>

</div>

<div class="colist arabic">

<ol>

<li>

<p>You use the <code>describe</code> function to group several tests together. The first argument to <code>describe</code> is the

description of this group of tests and the second argument is a function that will run the tests for this group.</p>

</li>

<li>

<p>You use the <code>test</code> function to define individual tests. The first argument is the description of the test and the

second argument is the function that will run the test.</p>

</li>

<li>

<p>Call the <code>reverseWords</code> function and store the result in the variable <code>result</code>, just as you did in the REPL.</p>

</li>

<li>

<p>Use the <code>expect</code> <em>matcher</em> to check that the <code>result</code> matches "world hello". If it doesn&#8217;t match, fail the test.</p>

</li>

</ol>

</div>

<div class="paragraph">

<p>Use <code>npm test</code> to run this test:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm test



&gt; sample-app@v4 test

&gt; jest --verbose



 PASS  ./reverse.test.js

  test reverseWords

    ✓ hello world =&gt; world hello (1 ms)



Test Suites: 1 passed, 1 total

Tests:       1 passed, 1 total

Snapshots:   0 total

Time:        0.192 s, estimated 1 s

Ran all test suites.</pre>

</div>

</div>

<div class="paragraph">

<p>The test passed! And it took all of 0.192 seconds, which is a whole lot faster than manually typing in a REPL.</p>

</div>

<div class="paragraph">

<p>Add a second test for <code>reverseWords</code> as shown in <a href="05.html#example_reverse_test_2">Example 78</a>:</p>

</div>

<div id="example_reverse_test_2" class="exampleblock">

<div class="title">Example 78. A second unit test for the <code>reverseWords</code> function (<em>ch4/sample-app/reverse.test.js</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="javascript">  test(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">trailing whitespace   =&gt; whitespace trailing</span><span style="color:#710">'</span></span>, () =&gt; {

    const result = reverse.reverseWords(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">trailing whitespace   </span><span style="color:#710">'</span></span>);

    expect(result).toBe(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">whitespace trailing</span><span style="color:#710">'</span></span>);

  });</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Re-run <code>npm test</code>:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm test



 FAIL  ./reverse.test.js

  test reverseWords

    ✓ hello world =&gt; world hello (1 ms)

    ✕ trailing whitespace   =&gt; whitespace trailing (1 ms)



  ● test reverseWords › trailing whitespace   =&gt; whitespace trailing



    expect(received).toBe(expected) // Object.is equality



    Expected: "whitespace trailing"

    Received: " whitespace trailing"



      17 |   test('trailing whitespace   =&gt; whitespace trailing', () =&gt; {

      18 |     const result = reverse.reverseWords('trailing whitespace   ');

    &gt; 19 |     expect(result).toBe('whitespace trailing');

         |                    ^

      20 |   });



      at Object.toBe (reverse.test.js:19:20)</pre>

</div>

</div>

<div class="paragraph">

<p>Oops. Looks like the code has a bug after all: it doesn&#8217;t handle trailing whitespace correctly. A powerful benefit of

automated testing is that you can create tests for all the various corner cases and find out if your code really does

what you expect. The fix for this issue shown in <a href="05.html#example_reverse_fixed">Example 79</a>:</p>

</div>

<div id="example_reverse_fixed" class="exampleblock">

<div class="title">Example 79. Fix whitespace handling in <code>reverseWords</code> (<em>ch4/sample-app/reverse.js</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="javascript"><span style="color:#080;font-weight:bold">function</span> <span style="color:#06B;font-weight:bold">reverseWords</span>(str) {

  <span style="color:#080;font-weight:bold">return</span> str

    .trim() // <b class="conum">(1)</b>

    .split(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20"> </span><span style="color:#710">'</span></span>)

    .reverse()

    .join(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20"> </span><span style="color:#710">'</span></span>);

}</code></pre>

</div>

</div>

</div>

</div>

<div class="colist arabic">

<ol>

<li>

<p>The fix is to use the <code>trim</code> function to strip leading and trailing whitespace.</p>

</li>

</ol>

</div>

<div class="paragraph">

<p>Re-run the tests to see if the fix worked:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm test



 PASS  ./reverse.test.js

  test reverseWords

    ✓ hello world =&gt; world hello (1 ms)

    ✓ trailing whitespace   =&gt; whitespace trailing</pre>

</div>

</div>

<div class="paragraph">

<p>That reveals one of the big wins with automated testing:</p>

</div>

<div class="admonitionblock tip">

<table>

<tr>

<td class="icon">

<div class="title">Tip</div>

</td>

<td class="content">

<div class="title">Key takeaway #4</div>

<div class="paragraph">

<p>Automated testing makes you more productive while coding by providing a rapid feedback loop: make a change, run the

tests, make another change, re-run the tests, and so on.</p>

</div>

</td>

</tr>

</table>

</div>

<div class="paragraph">

<p>Rapid feedback loops are a big part of the DevOps methodology, and a big part of being more productive as a programmer.

And this not only helps you fix the bug with whitespace faster, but now you also have a <em>regression test</em> in place that

will prevent that bug from coming back. This is also a massive boost to productivity, but one that&#8217;s harder to see:</p>

</div>

<div class="admonitionblock tip">

<table>

<tr>

<td class="icon">

<div class="title">Tip</div>

</td>

<td class="content">

<div class="title">Key takeaway #4</div>

<div class="paragraph">

<p>Automated testing makes you more productive in the future, too: you save a huge amount of time <em>not</em> having to fix

bugs because the tests prevented those bugs from slipping through in the first place.</p>

</div>

</td>

</tr>

</table>

</div>

<div class="paragraph">

<p>A useful feature available with some automated testing tools is the ability to measure <em>code coverage</em>: that is, what

percent of your code got executed by your tests? If your tests are only executing 10% of your code, then how much

confidence can you have that your code really works, and that there aren&#8217;t bugs hiding in the other 90%? To have Jest

measure code coverage, add the <code>--coverage</code> flag to the <code>test</code> command in <em>package.json</em>, as shown in

<a href="05.html#example_npm_package_json_test_coverage">Example 80</a>:</p>

</div>

<div id="example_npm_package_json_test_coverage" class="exampleblock">

<div class="title">Example 80. Update the test command to measure code coverage (<em>ch4/sample-app/package.json</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="json">    <span style="color:#606"><span style="color:#404">&quot;</span><span>test</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jest --verbose --coverage</span><span style="color:#710">&quot;</span></span></code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Run the tests one more time:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm test



 PASS  ./reverse.test.js

  test reverseWords

    ✓ hello world =&gt; world hello (1 ms)

    ✓ trailing whitespace   =&gt; whitespace trailing



------------|---------|----------|---------|---------|-------------------

File        | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s

------------|---------|----------|---------|---------|-------------------

All files   |   66.66 |      100 |      50 |   66.66 |

 reverse.js |   66.66 |      100 |      50 |   66.66 | 22

------------|---------|----------|---------|---------|-------------------</pre>

</div>

</div>

<div class="paragraph">

<p>You now get a table at the end of the output that shows each file and what percentage of the code was executed during

the automated tests. You should also see a new <em>coverage</em> folder that contains even more information, including some

HTML reports within <em>coverage/lcov-report/index.html</em>. Try opening this file in a browser:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ open coverage/lcov-report/index.html</pre>

</div>

</div>

<div class="paragraph">

<p>You should see a page that looks similar to <a href="05.html#code_coverage">Figure 36</a>:</p>

</div>

<div id="code_coverage" class="imageblock">

<div class="content">

<img src="images/ch4/code-coverage.png" alt="Code coverage output">

</div>

<div class="title">Figure 36. Code coverage output (<em>coverage/lcov-report/index.html</em>)</div>

</div>

<div class="paragraph">

<p>As you can see, you&#8217;re only testing about two-thirds of your code. To get more details into what you missed, click on

<em>reverse.js</em>, and you should see something similar to <a href="05.html#code_coverage_file">Figure 37</a>:</p>

</div>

<div id="code_coverage_file" class="imageblock">

<div class="content">

<img src="images/ch4/code-coverage-file.png" alt="Code coverage output for reverse.js">

</div>

<div class="title">Figure 37. Code coverage output for reverse.js (<em>coverage/lcov-report/index.html</em>)</div>

</div>

<div class="paragraph">

<p>This page shows you your own code: the green "2x" and "1x" indicate those parts of the code were executed during

testing twice or once, respectively. The highlighted code in red tells you code that wasn&#8217;t executed at all: of course,

there are no tests for the <code>reverseCharacters</code> function!</p>

</div>

<div class="paragraph">

<p>Now that code coverage has helped you see where your tests are lacking, head into <em>reverse.test.js</em>, and add a new unit

test for <code>reverseCharacters</code>, as shown in <a href="05.html#example_reverse_chars_test">Example 81</a>:</p>

</div>

<div id="example_reverse_chars_test" class="exampleblock">

<div class="title">Example 81. Add a unit test for <code>reverseCharacters</code> (<em>ch4/sample-app/reverse.test.js</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="javascript">describe(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">test reverseCharacters</span><span style="color:#710">'</span></span>, () =&gt; {

  test(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">abcd =&gt; dcba</span><span style="color:#710">'</span></span>, () =&gt; {

    const result = reverse.reverseCharacters(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">abcd</span><span style="color:#710">'</span></span>);

    expect(result).toBe(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">dcba</span><span style="color:#710">'</span></span>);

  });

});</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Run the tests one more time:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm test



 PASS  ./reverse.test.js

  test reverseWords

    ✓ hello world =&gt; world hello (1 ms)

    ✓ trailing whitespace   =&gt; whitespace trailing (1 ms)

  test reverseCharacters

    ✓ abcd =&gt; dcba



------------|---------|----------|---------|---------|-------------------

File        | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s

------------|---------|----------|---------|---------|-------------------

All files   |     100 |      100 |     100 |     100 |

 reverse.js |     100 |      100 |     100 |     100 |

------------|---------|----------|---------|---------|-------------------</pre>

</div>

</div>

<div class="paragraph">

<p>And there you go, all tests are passing, and code coverage is now at 100%.</p>

</div>

<div class="paragraph">

<p>Now that you have a feel for unit testing, let&#8217;s go back to the original problem of testing <em>app.js</em>, and add an

end-to-end test for the app: that is, a test that makes an HTTP request to the app, and checks the response. To do

that, you first need to split out the part of <em>app.js</em> that listens on a port into a separate file called <em>server.js</em>.

That way, you&#8217;ll be able to run multiple copies of your app concurrently during automated testing without getting

errors due to trying to listen on the same port.</p>

</div>

<div class="paragraph">

<p>First, update <em>app.js</em> to solely configure the Express app, and to export it, as shown in <a href="05.html#example_express_app_only">Example 82</a>:</p>

</div>

<div id="example_express_app_only" class="exampleblock">

<div class="title">Example 82. Update <em>app.js</em> to only create the app, but not listen on a port (<em>ch4/sample-app/app.js</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="javascript">const express = require(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">express</span><span style="color:#710">'</span></span>);



const app = express();



app.get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">/</span><span style="color:#710">'</span></span>, (req, res) =&gt; {

  res.send(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Hello, World!</span><span style="color:#710">'</span></span>);

});



module.exports = app;</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Next, create a new file called <em>server.js</em> that imports the code from <em>app.js</em> and has it listen on a port, as shown in

<a href="05.html#example_express_app_server">Example 83</a>:</p>

</div>

<div id="example_express_app_server" class="exampleblock">

<div class="title">Example 83. Create <em>server.js</em> to listen on a port (<em>ch4/sample-app/server.js</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="javascript">const app = require(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">./app</span><span style="color:#710">'</span></span>);



const port = <span style="color:#00D">8080</span>;



app.listen(port, () =&gt; {

  console.log(<span style="color:#F00;background-color:#FAA">`</span>Example app listening on port <span style="color:#369;font-weight:bold">$</span>{port}<span style="color:#F00;background-color:#FAA">`</span>);

});</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Make sure to update the <code>start</code> command in <em>package.json</em> to now use <em>server.js</em> instead of <em>app.js</em>, as shown in

<a href="05.html#example_npm_package_json_update_start">Example 84</a>:</p>

</div>

<div id="example_npm_package_json_update_start" class="exampleblock">

<div class="title">Example 84. Update the start command to run <em>server.js</em> (<em>ch4/sample-app/package.json</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="json">    <span style="color:#606"><span style="color:#404">&quot;</span><span>start</span><span style="color:#404">&quot;</span></span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">node server.js</span><span style="color:#710">&quot;</span></span>,</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Now, finally, you can add a test for the app in a new file called <em>app.test.js</em>, as shown in <a href="05.html#example_test_for_app">Example 85</a>:</p>

</div>

<div id="example_test_for_app" class="exampleblock">

<div class="title">Example 85. Add an automated test for the app (<em>ch4/sample-app/app.test.js</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="javascript">const request = require(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">supertest</span><span style="color:#710">'</span></span>);

const app = require(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">./app</span><span style="color:#710">'</span></span>);                     // <b class="conum">(1)</b>



describe(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Test the app</span><span style="color:#710">'</span></span>, () =&gt; {

  test(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Get / should return Hello, World!</span><span style="color:#710">'</span></span>, async () =&gt; {

    const response = await request(app).get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">/</span><span style="color:#710">'</span></span>); // <b class="conum">(2)</b>

    expect(response.statusCode).toBe(<span style="color:#00D">200</span>);        // <b class="conum">(3)</b>

    expect(response.text).toBe(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">'</span><span style="color:#D20">Hello, World!</span><span style="color:#710">'</span></span>);  // <b class="conum">(4)</b>

  });

});</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>Here&#8217;s how this test works:</p>

</div>

<div class="colist arabic">

<ol>

<li>

<p>Import the app code from <em>app.js</em>.</p>

</li>

<li>

<p>Use the SuperTest library (imported under the name <code>request</code>) to fire up the app and make an HTTP GET request to

it at the "/" URL.</p>

</li>

<li>

<p>Check that the response status code from the app is a 200 OK.</p>

</li>

<li>

<p>Check that the response body from the app is the text "Hello, World!"</p>

</li>

</ol>

</div>

<div class="paragraph">

<p>Re-run the tests one more time:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ npm test



 PASS  ./app.test.js

  Test the app

    ✓ Get / should return Hello, World! (14 ms)



 PASS  ./reverse.test.js

  test reverseWords

    ✓ hello world =&gt; world hello

    ✓ trailing whitespace   =&gt; whitespace trailing

  test reverseCharacters

    ✓ abcd =&gt; dcba (1 ms)



------------|---------|----------|---------|---------|-------------------

File        | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s

------------|---------|----------|---------|---------|-------------------

All files   |     100 |      100 |     100 |     100 |

 app.js     |     100 |      100 |     100 |     100 |

 reverse.js |     100 |      100 |     100 |     100 |

------------|---------|----------|---------|---------|-------------------

Test Suites: 2 passed, 2 total

Tests:       4 passed, 4 total

Snapshots:   0 total

Time:        0.345 s, estimated 1 s</pre>

</div>

</div>

<div class="paragraph">

<p>Excellent! All your tests are passing, you have 100% code coverage, and all of this runs in just 0.345 seconds.</p>

</div>

<div class="admonitionblock tip">

<table>

<tr>

<td class="icon">

<div class="title">Tip</div>

</td>

<td class="content">

<div class="title">Get your hands dirty</div>

<div class="paragraph">

<p>Here are a few exercises you can try at home to get a better feel for writing automated tests for app code:</p>

</div>

<div class="ulist">

<ul>

<li>

<p>Add a new endpoint to the sample app and add a new automated test to validate the endpoint works as

expected.</p>

</li>

</ul>

</div>

</td>

</tr>

</table>

</div>

</div>

<div class="sect3">

<h3 id="example_automated_tests_tofu">Example: add automated tests for your OpenTofu code</h3>

<div class="paragraph">

<p>It&#8217;s a good idea to write automated tests not only for app code, but for your infrastructure code, too. The tooling

for infrastructure tests isn&#8217;t as mature and the tests take longer to run, but they give all the same benefits.</p>

</div>

<div class="paragraph">

<p>As an example, let&#8217;s add automated tests for the <code>lambda-sample</code> OpenTofu module you built in <a href="04.html#example_serverless">Section 3.5.1</a>.

Copy that module, unchanged, from your work in that blog post into a folder for this

blog post:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ cd fundamentals-of-devops

$ mkdir -p ch4/tofu/live

$ cp -r ch3/tofu/live/lambda-sample ch4/tofu/live

$ cd ch4/tofu/live/lambda-sample</pre>

</div>

</div>

<div class="paragraph">

<p>There are several approaches to testing OpenTofu code, including the following:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">Static analysis</dt>

<dd>

<p>Using tools such as <a href="https://runterrascan.io/">Terrascan</a>,

<a href="https://aquasecurity.github.io/trivy/">Trivy</a>, and <a href="https://github.com/terraform-linters/tflint">tflint</a>.</p>

</dd>

<dt class="hdlist1">Policy enforcement</dt>

<dd>

<p>Using tools such as <a href="https://www.openpolicyagent.org/">Open Policy Agent</a> and

<a href="https://www.hashicorp.com/sentinel">Sentinel</a>.</p>

</dd>

<dt class="hdlist1">Plan testing</dt>

<dd>

<p>Using tools such as the <a href="https://opentofu.org/docs/cli/commands/test/">built-in <code>test</code> command</a>,

<a href="https://www.openpolicyagent.org/">Open Policy Agent</a>, and <a href="https://terratest.gruntwork.io/">Terratest</a>.</p>

</dd>

<dt class="hdlist1">Unit, integration, and end-to-end testing</dt>

<dd>

<p>Using the <a href="https://opentofu.org/docs/cli/commands/test/">built-in <code>test</code>

command</a> (which works for simple modules and tests) and <a href="https://terratest.gruntwork.io/">Terratest</a> (which is a better

option for more complex modules and tests).</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>Any testing is better than none, so at an absolute bare minimum, you should set up static analysis, as it takes very

little effort, runs quickly, and will catch certain types of bugs and security issues. The next section shows you an

example of how to do that.</p>

</div>

<div class="sect4">

<h4 id="_example_add_static_analysis_for_your_opentofu_code_using_terrascan">Example: add static analysis for your OpenTofu code using Terrascan</h4>

<div class="paragraph">

<p>As an example, let&#8217;s use Terrascan as a static analysis tool for OpenTofu. First, create a config file for Terrascan

called <em>terrascan.toml</em>, with the contents shown in <a href="05.html#terrascan_config">Example 86</a>:</p>

</div>

<div id="terrascan_config" class="exampleblock">

<div class="title">Example 86. Config file for Terrascan (<em>ch4/tofu/live/lambda-sample/terrascan.toml</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="toml">[severity]

level = &quot;high&quot;</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>This file supports a number of configuration settings for Terrascan, but the only one you need for now is to

configure Terrascan to only show high severity errors. The lower severity ones aren&#8217;t relevant for our simple

example here, but you may wish to look at them for production code.</p>

</div>

<div class="paragraph">

<p>Next, <a href="https://runterrascan.io/docs/getting-started/#installing-terrascan">install Terrascan</a>, and run it in the

<em>lambda-sample</em> folder as follows:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ terrascan scan \

  --iac-type terraform \

  --non-recursive \

  --verbose \

  -c terrascan.toml</pre>

</div>

</div>

<div class="paragraph">

<p>The preceding command uses the following flags:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1"><code>--iac-type terraform</code></dt>

<dd>

<p>Analyze only Terraform or OpenTofu code.</p>

</dd>

<dt class="hdlist1"><code>--non-recursive</code></dt>

<dd>

<p>By default, Terrascan tries to scan everything in the current folder and all subfolders. This flag avoid Terrascan

scanning the <code>src</code>  folder within <code>lambda-sample</code> and complaining that folder doesn&#8217;t contain OpenTofu code.</p>

</dd>

<dt class="hdlist1"><code>--verbose</code></dt>

<dd>

<p>This gives a bit of extra log output, including Rule IDs for any policies that have been violated.</p>

</dd>

<dt class="hdlist1"><code>-c terrascan.toml</code></dt>

<dd>

<p>Use the settings in the configuration file <em>terrascan.toml</em> you created.</p>

</dd>

</dl>

</div>

<div class="paragraph">

<p>When you run Terrascan, it should identify one policy violation:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>Violation Details -



Description  :	Lambda does not use KMS CMK key to protect environment variables.

File         :	main.tf

Module Name  :	root

Plan Root    :	./

Line         :	7

Severity     :	HIGH

Rule Name    :	lambdaNotEncryptedWithKms

Rule ID      :	AC_AWS_0483

Resource Name:	function

Resource Type:	aws_lambda_function

Category     :	Data Protection</pre>

</div>

</div>

<div class="paragraph">

<p>Terrascan has found that the environment variables you&#8217;re passing to the Lambda function are not encrypted. If those

environment variables contained any secrets, this would be a serious issue, so it&#8217;s great to have that flagged for us.

That said, in this simple example, you&#8217;re not passing any secrets around, so you can tell Terrascan to skip this check

by adding its Rule ID to the <code>skip-rules</code> section of your Terrascan configuration file as shown in

<a href="05.html#example_tofu_lambda_skip_ts">Example 87</a>:</p>

</div>

<div id="example_tofu_lambda_skip_ts" class="exampleblock">

<div class="title">Example 87. Configure Terrascan to skip a policy check (<em>ch4/tofu/live/lambda-sample/terrascan.toml</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="toml">[rules]

    skip-rules = [

        # We are not passing any secrets to Lambda via env vars

        &quot;AC_AWS_0483&quot;

    ]</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>If you re-run Terrascan, it&#8217;ll still show the policy violation, but this time, it won&#8217;t cause the check to fail.</p>

</div>

<div class="paragraph">

<p>Static analysis is good, but a unit test is even better, as it actually executes your code and checks its

functionality, which allows you to catch a much wider variety of errors.</p>

</div>

</div>

<div class="sect4">

<h4 id="_example_add_unit_tests_for_your_opentofu_code_using_the_test_command">Example: add unit tests for your OpenTofu code using the test command</h4>

<div class="paragraph">

<p>As an example, let&#8217;s add a unit test that uses OpenTofu&#8217;s built-in <code>test</code> command. Note that these tests will deploy

real resources into your AWS account, so in some sense, they are closer to integration tests, but because you&#8217;re going

to be testing just a single unit—a single module—I&#8217;ll stick with the term unit test to disambiguate from tests that

test the integration of multiple modules together.</p>

</div>

<div class="paragraph">

<p>First, you need to add a small helper module for testing HTTP endpoints. The blog post series&#8217;s

<a href="https://github.com/brikis98/fundamentals-of-devops-code">sample code repo</a> includes a module called <code>test-endpoint</code> in the

<em>ch4/tofu/modules/test-endpoint</em> folder that can make an HTTP request to an endpoint you specify. Normally, you could

use this module directly from GitHub, but currently, the <code>test</code> command has a limitation where it can only use local

modules, so <code>git clone</code> the sample code repo (if you haven&#8217;t already) to the <em>fundamentals-of-devops-code</em> folder and

make a copy of the <code>test-endpoint</code> module:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ cd fundamentals-of-devops

$ mkdir -p ch4/tofu/modules

$ cp -r ../fundamentals-of-devops-code/ch4/tofu/modules/test-endpoint ch4/tofu/modules</pre>

</div>

</div>

<div class="paragraph">

<p>Next, in the <code>lambda-sample</code> module, create a file called <em>deploy.tftest.hcl</em>, with the contents shown in

<a href="05.html#example_tofu_test_lambda">Example 88</a>:</p>

</div>

<div id="example_tofu_test_lambda" class="exampleblock">

<div class="title">Example 88. Automated test for the <code>lambda-sample</code> module (<em>ch4/tofu/live/lambda-sample/deploy.tftest.hcl</em>)</div>

<div class="content">

<div class="listingblock">

<div class="content">

<pre class="CodeRay highlight"><code data-lang="terraform"># <b class="conum">(1)</b>

run &quot;deploy&quot; {

  command = apply

}



# <b class="conum">(2)</b>

run &quot;validate&quot; {

  command = apply



  # <b class="conum">(3)</b>

  module {

    source = &quot;../../modules/test-endpoint&quot;

  }



  # <b class="conum">(4)</b>

  variables {

    endpoint = run.deploy.api_endpoint

  }



  # <b class="conum">(5)</b>

  assert {

    condition     = data.http.test_endpoint.status_code == 200

    error_message = &quot;Website responded with HTTP status ${data.http.test_endpoint.status_code}&quot;

  }



  # <b class="conum">(6)</b>

  assert {

    condition     = data.http.test_endpoint.response_body == &quot;Hello, World!&quot;

    error_message = &quot;Website responded with body ${data.http.test_endpoint.response_body}&quot;

  }

}</code></pre>

</div>

</div>

</div>

</div>

<div class="paragraph">

<p>This automated test is written in the same language (HCL) as the rest of OpenTofu code. You put these tests into

files with the <em>.tftest.hcl</em> extension, and they primarily consist of <code>run</code> blocks that OpenTofu executes

sequentially:</p>

</div>

<div class="colist arabic">

<ol>

<li>

<p>The first <code>run</code> block will run <code>apply</code> on the <code>lambda-sample</code> module itself.</p>

</li>

<li>

<p>The second <code>run</code> block will run <code>apply</code> as well, but this time on a <code>test-endpoint</code> module, as described in (3).</p>

</li>

<li>

<p>This <code>module</code> block is how you tell the <code>run</code> block to run <code>apply</code> on the <code>test-endpoint</code> module, which is the

module you copied from the blog post series&#8217;s sample code repo.</p>

</li>

<li>

<p>Read the API Gateway endpoint output from the <code>lambda-sample</code> module and pass it in as the <code>endpoint</code> input

variable for the <code>test-endpoint</code> module.</p>

</li>

<li>

<p><code>assert</code> blocks are used to check if the code actually works as you expect. This first <code>assert</code> block checks that

the <code>test-endpoint</code> module&#8217;s HTTP request got a response status code of 200 OK.</p>

</li>

<li>

<p>The second <code>assert</code> block checks that the <code>test-endpoint</code> module&#8217;s HTTP request got a response body with the text

"Hello, World!"</p>

</li>

</ol>

</div>

<div class="paragraph">

<p>To run this test, authenticate to AWS as described in <a href="03.html#example_authenticate_on_the_cli">Section 2.2</a>, and use the <code>tofu test</code>

command:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ tofu test

deploy.tftest.hcl... pass

  run "deploy"... pass

  run "validate"... pass



Success! 2 passed, 0 failed.</pre>

</div>

</div>

<div class="paragraph">

<p>OpenTofu will run <code>apply</code>, deploy your real resources, and then, at the end of the test, run <code>destroy</code> to clean

everything up again. These tests take several minutes to run, so be patient. But when they are done, you can have

reasonable confidence that your module deploys infrastructure that really works.</p>

</div>

<div class="admonitionblock tip">

<table>

<tr>

<td class="icon">

<div class="title">Tip</div>

</td>

<td class="content">

<div class="title">Get your hands dirty</div>

<div class="paragraph">

<p>Here are a few exercises you can try at home to get a better feel for writing automated tests for infrastructure code:</p>

</div>

<div class="ulist">

<ul>

<li>

<p>Figure out how to encrypt the environment variables in the <code>lambda</code> module, which is a better fix for the Terrascan

error.</p>

</li>

<li>

<p>Add a new endpoint in your <code>lambda</code> module and add a new automated test to validate the endpoint works as

expected.</p>

</li>

</ul>

</div>

</td>

</tr>

</table>

</div>

</div>

</div>

<div class="sect3">

<h3 id="_testing_best_practices">Testing best practices</h3>

<div class="paragraph">

<p>Now that you understand the basics of automated testing, let&#8217;s discuss the best practices:</p>

</div>

<div class="ulist">

<ul>

<li>

<p>The test pyramid</p>

</li>

<li>

<p>What to test</p>

</li>

<li>

<p>Test-Driven Development (TDD)</p>

</li>

</ul>

</div>

<div class="sect4">

<h4 id="_the_test_pyramid">The test pyramid</h4>

<div class="paragraph">

<p>One question that comes up often is, which testing approach should you use? Unit tests? Integration tests? E2E tests?</p>

</div>

<div class="paragraph">

<p>The answer is: a mix of all of them! Each type of test has different types of errors they can catch, plus different

strengths and weaknesses, as summarized in <a href="05.html#test_strengths_weaknesses">Table 4</a>:</p>

</div>

<table id="test_strengths_weaknesses" class="tableblock frame-all grid-all stretch">

<caption class="title">Table 4. A comparison of different types of automated tests</caption>

<colgroup>

<col style="width: 11.1111%;">

<col style="width: 11.1111%;">

<col style="width: 11.1111%;">

<col style="width: 11.1111%;">

<col style="width: 11.1111%;">

<col style="width: 11.1111%;">

<col style="width: 11.1111%;">

<col style="width: 11.1111%;">

<col style="width: 11.1112%;">

</colgroup>

<thead>

<tr>

<th class="tableblock halign-left valign-top"></th>

<th class="tableblock halign-left valign-top">Compiler</th>

<th class="tableblock halign-left valign-top">Static analysis</th>

<th class="tableblock halign-left valign-top">Policy tests</th>

<th class="tableblock halign-left valign-top">Plan tests</th>

<th class="tableblock halign-left valign-top">Unit tests</th>

<th class="tableblock halign-left valign-top">Integration tests</th>

<th class="tableblock halign-left valign-top">E2E tests</th>

<th class="tableblock halign-left valign-top">Perf tests</th>

</tr>

</thead>

<tbody>

<tr>

<td class="tableblock halign-left valign-top"><p class="tableblock">Syntax errors</p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

</tr>

<tr>

<td class="tableblock halign-left valign-top"><p class="tableblock">Type errors</p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

</tr>

<tr>

<td class="tableblock halign-left valign-top"><p class="tableblock">Compliance errors</p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

</tr>

<tr>

<td class="tableblock halign-left valign-top"><p class="tableblock">Unit functionality</p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="yellow-background"><strong>Partial</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

</tr>

<tr>

<td class="tableblock halign-left valign-top"><p class="tableblock">Interaction of units</p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

</tr>

<tr>

<td class="tableblock halign-left valign-top"><p class="tableblock">System functionality</p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

</tr>

<tr>

<td class="tableblock halign-left valign-top"><p class="tableblock">Functionality under load</p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>No</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Yes</strong></span></p></td>

</tr>

<tr>

<td class="tableblock halign-left valign-top"><p class="tableblock">Speed</p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Very fast</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Very fast</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Very fast</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="aqua-background"><strong>Fast</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="aqua-background"><strong>Fast</strong></span>/<span class="teal-background"><strong>Moderate</strong></span> <sup class="footnote">[<a id="_footnoteref_33" class="footnote" href="13-footnotes.html#_footnotedef_33" title="View footnote.">33</a>]</sup></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="yellow-background"><strong>Slow</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>Very slow</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>Very slow</strong></span></p></td>

</tr>

<tr>

<td class="tableblock halign-left valign-top"><p class="tableblock">Stability</p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Very stable</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Very stable</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Very stable</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="aqua-background"><strong>Stable</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="aqua-background"><strong>Stable</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="yellow-background"><strong>Flaky</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>Very flaky</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>Very flaky</strong></span></p></td>

</tr>

<tr>

<td class="tableblock halign-left valign-top"><p class="tableblock">Ease of use</p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="aqua-background"><strong>Easy</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="lime-background"><strong>Very easy</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="aqua-background"><strong>Easy</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="aqua-background"><strong>Easy</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="teal-background"><strong>Moderate</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="yellow-background"><strong>Hard</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>Very hard</strong></span></p></td>

<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="red-background"><strong>Very hard</strong></span></p></td>

</tr>

</tbody>

</table>

<div class="paragraph">

<p>The only way to be confident your code works as expected is to combine multiple types of tests. That doesn&#8217;t mean that

you use all the different types of tests in equal proportion. In most cases, you want the proportion of tests to follow

the <em>test pyramid</em> shown in <a href="05.html#test_pyramid">Figure 38</a>:</p>

</div>

<div id="test_pyramid" class="imageblock">

<div class="content">

<img src="images/ch4/test-pyramid.png" alt="The test pyramid">

</div>

<div class="title">Figure 38. The test pyramid</div>

</div>

<div class="paragraph">

<p>The idea of the test pyramid is that, as you go up the pyramid, the cost and complexity of writing the tests, the

brittleness of the tests, and the runtime of the tests all increase. Therefore, you typically want to do as much

testing as you can with the types of tests that are fast to write, fast to run, and stable, which means the majority

of your testing (the base of the pyramid), should leverage the compiler, static analysis, plan tests, policy tests,

and unit tests. You then have a smaller number of integration tests (the middle of the pyramid), and an even smaller

number of very high-value end-to-end and performance tests (the top of the pyramid).</p>

</div>

<div class="paragraph">

<p>Moreover, you don&#8217;t have to add all the different types of tests at once. Instead, pick the ones that give you the best

bang for your buck and add those first. Almost any testing is better than none. If all you can add for now is

static analysis or unit tests, then that&#8217;s still better than no tests. Or maybe the highest value in your use case is

a single end-to-end test that verifies your system really works: that&#8217;s a perfectly fine starting point, too. Start

with something, anything that gives you value, and then add more and more tests incrementally.</p>

</div>

</div>

<div class="sect4">

<h4 id="_what_to_test">What to test</h4>

<div class="paragraph">

<p>Another question that comes up often is, what should you test? There are some testing purists out there who believe

that every line of code must be tested and that your tests must achieve 100% code coverage. I am not one of them.</p>

</div>

<div class="paragraph">

<p>There is no doubt that tests offer a huge amount of value. But they also have a cost. Writing tests, maintaining them,

and ensuring they run quickly and reliably can take a lot of time. In many cases, this overhead is worth it. In some

cases, it&#8217;s not. In practice, I&#8217;ve found that deciding if you should invest in adding automated tests for a certain part

of your code comes down to continuously evaluating your testing strategy and making trade-offs between the following

factors:</p>

</div>

<div class="dlist">

<dl>

<dt class="hdlist1">The cost of bugs</dt>

<dd>

<p>If you&#8217;re building a prototype that you&#8217;ll most likely throw away in a week, the cost of bugs is low. If you&#8217;re

building a payment processing system, the cost of bugs is very high—you don&#8217;t want to charge a customer&#8217;s

credit card twice or for the wrong amount. Bugs are also costly in any system that touches data storage (i.e., any

code that can delete or corrupt user data) and any code related to security (e.g., authentication, authorization,

encryption). If you have some part of your system that simply cannot be allowed to break, you should invest in

automated tests.</p>

</dd>

<dt class="hdlist1">The likelihood of bugs</dt>

<dd>

<p>As a codebase gets larger, it is less likely that you can keep it working solely through manual testing. Similarly,

as you increase the number of people working on the same code, automated tests become crucial to avoid integration

bugs and as a way to document what the code should do. It&#8217;s also worth mentioning that some technical problems

are inherently more complicated, so you&#8217;ll need more tests to solve them correctly. For example, you might want to

write automated tests if you&#8217;re solving complicated math problems or writing your own distributed consensus

algorithms.</p>

</dd>

<dt class="hdlist1">The cost of testing</dt>

<dd>

<p>With most languages and tools, setting up unit tests is so easy, the tests run so fast, and the improvement to code

quality and correctness is so high that it is almost always worth writing unit tests. On the other hand,

integration tests, end-to-end tests, and performance tests are each progressively more expensive to set up, so

whether it&#8217;s worth paying the cost depends on just how high that cost is, and what you&#8217;ll get in return.</p>

</dd>

<dt class="hdlist1">The cost of <em>not</em> having tests</dt>

<dd>

<p>It&#8217;s possible to get lost in an analytical cost/benefit analysis and conclude that tests aren&#8217;t worth it. Many

companies do just that. But you have to remember that this has a cost, too: fear. When you work in a codebase without

tests, you end up with a bunch of developers who are afraid to make changes. So if every time you go to add a new

feature or deploy something to production, you find your team hesitating and stalling, then you are paying a high

cost for not having tests, and it can cause your company to grind to a halt. In those cases, the cost of automated

tests is far lower than the cost of having a paralyzed dev team.</p>

</dd>

</dl>

</div>

</div>

<div class="sect4">

<h4 id="_test_driven_development_tdd">Test-Driven Development (TDD)</h4>

<div class="paragraph">

<p>The mere act of trying to write tests for your code will force you to take a step back and ask some important

questions: How do I structure the code so I can test it? What dependencies do I have? What are the common use cases?

What are the corner cases?</p>

</div>

<div class="paragraph">

<p>If you find that your code is hard to test, it&#8217;s almost always a sign that it needs to be refactored for other reasons,

too. For example, if the code uses lots of mutable state and side effects, it will not only be hard to test but also

hard to reuse and reason about the code. If the code is difficult to test because it has many complex interactions with

its dependencies, then it&#8217;s likely that the code is too tightly coupled and will be difficult to change. If the code is

hard to test because there are too many use cases to cover, then that&#8217;s a sign that the code is doing too much and

needs to be broken up.</p>

</div>

<div class="paragraph">

<p>In other words, tests not only help you write correct code, they also provide feedback that leads to a better design.

You get the most benefit from this feedback if you write the test code <em>before</em> you write the implementation code. This

is known as <em>test-driven development</em> (TDD).</p>

</div>

<div class="paragraph">

<p>The TDD cycle is:</p>

</div>

<div class="olist arabic">

<ol class="arabic">

<li>

<p>Add basic placeholders for the new functionality (e.g., the function signatures), just enough for the code to compile,

but don&#8217;t actually implement the functionality.</p>

</li>

<li>

<p>Add tests for the new functionality.</p>

</li>

<li>

<p>Run all the tests. The new tests should fail, but all other tests should pass.</p>

</li>

<li>

<p>Implement the new functionality.</p>

</li>

<li>

<p>Rerun the tests. Everything should now pass.</p>

</li>

<li>

<p>Refactor the code until you have a clean design, re-running the tests regularly to check everything is still working.</p>

</li>

</ol>

</div>

<div class="paragraph">

<p>One of the unexpected consequences of using TDD is that the design of your code <em>emerges</em> as a result of a repeated

test-code-test cycle. Without TDD, you often end up shipping the first design you can think of; with TDD, the very act

of trying to figure out how to write tests forces you to iterate on your design, and you often ship something more

effective.</p>

</div>

<div class="paragraph">

<p>In fact, TDD affects not only the design of small parts of your code, but also the design of your entire system. Some

TDD practitioners use TDD only for writing unit tests up front, but you can also use TDD with integration tests,

end-to-end tests, and performance tests. Thinking about integration tests up front forces you to consider how the

different parts of your system will communicate with one another. Thinking about end-to-end up front forces you to

think through how to deploy everything. Thinking about performance tests up front forces you to think about where your

bottlenecks are and what metrics you need to gather to identify them.</p>

</div>

<div class="paragraph">

<p>Being forced to think through all of this up front, simply because you try to write tests first, can have a profoundly

positive impact on the final design. If you want to see some concrete examples of how TDD leads to emerging design, see

<em>Growing Object-Oriented Software, Guided by Tests</em> by Steve Freeman and Nat Pryce (Addison-Wesley Professional), as

well as my previous book, <em>Hello, Startup: A Programmer&#8217;s Guide to Building Products, Technologies, and Teams</em>

(O&#8217;Reilly).</p>

</div>

<div class="paragraph">

<p>It&#8217;s also worth mentioning that writing tests up front increases the chances that you&#8217;ll have thorough test coverage,

because it forces you to write code incrementally. Tests can be tedious to write, so it&#8217;s easier if you only have to do

a few at a time: write a few tests and then a little bit of implementation, then a few more tests, then a little more

implementation, and so on. It&#8217;s less effective to spend weeks writing thousands of lines of implementation code and

then try to go back and do a marathon session of writing test cases for all of it. You&#8217;ll get bored and end up with

far less code coverage. You&#8217;ll also miss many corner cases because you&#8217;ll forget the nuances of implementation code you

wrote weeks ago.</p>

</div>

<div class="paragraph">

<p>Note that not all types of coding are a good fit for TDD. For example, if you&#8217;re doing <em>exploratory coding</em>, where you

don&#8217;t yet know exactly what you&#8217;re building, and you&#8217;re just exploring the problem space by coding and messing with

data, TDD might not be a good fit. If you don&#8217;t know what result you&#8217;re looking for, you can&#8217;t write a test for it.

In that case, writing tests shortly after you write the code is still valuable.</p>

</div>

<div class="paragraph">

<p>Also, if you&#8217;re working on an existing codebase that doesn&#8217;t have any tests (a legacy codebase), then you might feel

like TDD doesn&#8217;t apply, as the development is already done. However, you can still use TDD for any changes you make to

the codebase. It&#8217;s very similar to the standard TDD process, but with a couple steps at the front:</p>

</div>

<div class="olist arabic">

<ol class="arabic">

<li>

<p>Write a test for the functionality you&#8217;re about to modify.</p>

</li>

<li>

<p>Run all the tests. They should all pass.</p>

</li>

<li>

<p>Now use the standard TDD process for any new functionality or changes you&#8217;re about to make.</p>

</li>

</ol>

</div>

<div class="paragraph">

<p>This way, you incrementally build out the test coverage for the codebase, specifically in those parts of the code that

you&#8217;re modifying. Each test you add for the existing functionality gives you a way to prove to yourself that you truly

understand how that code works, which can make it less scary to start making changes; and each test you add for new

functionality gives you all the standard benefits of TDD. And when you&#8217;re done, you leave the codebase with at least a

few tests in place, which will make it less scary—make it feel less like legacy code—for the next developer.</p>

</div>

<div class="paragraph">

<p>TDD is also useful for bug fixing. If you found a bug in production, that means there was no test that caught the

problem, so a good way to start on the fix is, as a first step, to write a failing test that reproduces the bug

(test-driven bug fixing). That proves you understand the cause of the bug and, after you fix it, leaves you with an

regression test that will prevent the bug from coming back.</p>

</div>

</div>

</div>

</div>

<div class="sect2">

<h2 id="_conclusion_4">Conclusion</h2>

<div class="admonitionblock note">

<table>

<tr>

<td class="icon">

<div class="title">Note</div>

</td>

<td class="content">

<div class="title">Reminder: commit your code!</div>

<div class="paragraph">

<p>While working through this blog post, you&#8217;ve probably made a lot of code changes in the <em>ch4</em> folder:

e.g., updating <em>package.json</em> with build steps and dependencies, switching to an Express app, adding automated tests

for the app and infrastructure code, and so on. If you haven&#8217;t already, make sure to commit all this code—especially

changes in the <em>sample-app</em> and <em>tofu</em> folders—so you don&#8217;t lose it and can iterate on it in future

posts:</p>

</div>

<div class="listingblock">

<div class="content">

<pre>$ cd fundamentals-of-devops/ch4

$ git add sample-app tofu

$ git commit -m "Add ch4 sample code"

$ git push origin main</pre>

</div>

</div>

</td>

</tr>

</table>

</div>

<div class="paragraph">

<p>You&#8217;ve now taken a big step forward in allowing your team members to collaborate on your code by following the

4 key takeaways from this Part:</p>

</div>

<div class="ulist">

<ul>

<li>

<p>Always manage your code with a version control system.</p>

</li>

<li>

<p>Use a build system to capture, as code, important operations and knowledge for your project, in a way that can be

used both by developers and automated tools.</p>

</li>

<li>

<p>Use a dependency management tool to pull in dependencies—not copy &amp; paste.</p>

</li>

<li>

<p>Use automated tests to give your team the confidence to make changes quickly.</p>

</li>

<li>

<p>Automated testing makes you more productive while coding by providing a rapid feedback loop: make a change, run the

tests, make another change, re-run the tests, and so on.</p>

</li>

<li>

<p>Automated testing makes you more productive in the future, too: you save a huge amount of time <em>not</em> having to fix

bugs because the tests prevented those bugs from slipping through in the first place.</p>

</li>

</ul>

</div>

<div class="paragraph">

<p>This is terrific progress, but it doesn&#8217;t solve the collaboration problem fully. You have a version control system, but

if teams go off and work in branches for months, it becomes incredibly hard to merge their work back together; you have

automated tests, but developers don&#8217;t always remember to run them, so broken code still slips by; and you have a build

system that automates some operations, but deployments are still largely manual. To implement a full, effective SDLC,

you need two more ingredients: continuous integration (CI) and continuous delivery (CD), which are the topics of the

next blog post, <a href="06.html#how_to_set_up_ci_cd">Part 5</a>.</p>

</div>

</div>

</div>

</div>

</div>

<nav aria-label="Blog post series navigation" style="margin-top: 25px; margin-bottom: 50px;">
  <ul class="pagination justify-content-center">
    <li class="page-item ">
      <a class="page-link" href="04.html">Previous part</a>
    </li>
    <li class="page-item "><a class="page-link" href="index.html">0</a></li>
<li class="page-item "><a class="page-link" href="02.html">1</a></li>
<li class="page-item "><a class="page-link" href="03.html">2</a></li>
<li class="page-item "><a class="page-link" href="04.html">3</a></li>
<li class="page-item active"><span class="page-link">4</span></li>
<li class="page-item "><a class="page-link" href="06.html">5</a></li>
<li class="page-item "><a class="page-link" href="07.html">6</a></li>
<li class="page-item "><a class="page-link" href="08.html">7</a></li>
<li class="page-item "><a class="page-link" href="09.html">8</a></li>
<li class="page-item "><a class="page-link" href="10.html">9</a></li>
<li class="page-item "><a class="page-link" href="11.html">10</a></li>
<li class="page-item "><a class="page-link" href="12.html">11</a></li>
    <li class="page-item ">
      <a class="page-link" href="06.html">Next part</a>
    </li>
  </ul>
</nav>

<div id="footer">

<div id="footer-text">

Last updated 2024-05-20 14:12:46 -0400

</div>

</div>


    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

<script src="https://cdn.jsdelivr.net/npm/anchor-js/anchor.min.js"></script>
<script>
  anchors.add();
</script>

</body>

</html>